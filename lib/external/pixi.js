/*
 * @license
 * Pixi.JS - v1.4.0 dev build
 * Copyright (c) 2012, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2013-12-30
 *
 * Pixi.JS is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(){var d=d||{};d.Point=function(c,e){this.x=c||0;this.y=e||0};d.Point.prototype.clone=function(){return new d.Point(this.x,this.y)};d.Point.prototype.constructor=d.Point;d.Rectangle=function(c,e,f,d){this.x=c||0;this.y=e||0;this.width=f||0;this.height=d||0};d.Rectangle.prototype.clone=function(){return new d.Rectangle(this.x,this.y,this.width,this.height)};d.Rectangle.prototype.contains=function(c,e){if(0>=this.width||0>=this.height)return!1;var f=this.x;return c>=f&&c<=f+this.width&&(f=
this.y,e>=f&&e<=f+this.height)?!0:!1};d.Rectangle.prototype.constructor=d.Rectangle;d.Polygon=function(c){c instanceof Array||(c=Array.prototype.slice.call(arguments));if("number"===typeof c[0]){for(var e=[],f=0,k=c.length;f<k;f+=2)e.push(new d.Point(c[f],c[f+1]));c=e}this.points=c};d.Polygon.prototype.clone=function(){for(var c=[],e=0;e<this.points.length;e++)c.push(this.points[e].clone());return new d.Polygon(c)};d.Polygon.prototype.contains=function(c,e){for(var f=!1,d=0,h=this.points.length-1;d<
this.points.length;h=d++){var l=this.points[d].x,m=this.points[d].y,n=this.points[h].x,h=this.points[h].y;m>e!==h>e&&c<(n-l)*(e-m)/(h-m)+l&&(f=!f)}return f};d.Polygon.prototype.constructor=d.Polygon;d.Circle=function(c,e,f){this.x=c||0;this.y=e||0;this.radius=f||0};d.Circle.prototype.clone=function(){return new d.Circle(this.x,this.y,this.radius)};d.Circle.prototype.contains=function(c,e){if(0>=this.radius)return!1;var f=this.x-c,d=this.y-e,h=this.radius*this.radius;return f*f+d*d<=h};d.Circle.prototype.constructor=
d.Circle;d.Ellipse=function(c,e,f,d){this.x=c||0;this.y=e||0;this.width=f||0;this.height=d||0};d.Ellipse.prototype.clone=function(){return new d.Ellipse(this.x,this.y,this.width,this.height)};d.Ellipse.prototype.contains=function(c,e){if(0>=this.width||0>=this.height)return!1;var f=(c-this.x)/this.width-0.5,d=(e-this.y)/this.height-0.5;return 0.25>f*f+d*d};d.Ellipse.prototype.getBounds=function(){return new d.Rectangle(this.x,this.y,this.width,this.height)};d.Ellipse.prototype.constructor=d.Ellipse;
d.Matrix="undefined"!==typeof Float32Array?Float32Array:Array;d.mat3={};d.mat3.create=function(){var c=new d.Matrix(9);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};d.mat3.identity=function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};d.mat4={};d.mat4.create=function(){var c=new d.Matrix(16);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.mat3.multiply=function(c,
e,f){f||(f=c);var d=c[0],h=c[1],l=c[2],m=c[3],n=c[4],s=c[5],q=c[6],u=c[7];c=c[8];var p=e[0],t=e[1],v=e[2],z=e[3],x=e[4],D=e[5],A=e[6],w=e[7];e=e[8];f[0]=p*d+t*m+v*q;f[1]=p*h+t*n+v*u;f[2]=p*l+t*s+v*c;f[3]=z*d+x*m+D*q;f[4]=z*h+x*n+D*u;f[5]=z*l+x*s+D*c;f[6]=A*d+w*m+e*q;f[7]=A*h+w*n+e*u;f[8]=A*l+w*s+e*c;return f};d.mat3.clone=function(c){var e=new d.Matrix(9);e[0]=c[0];e[1]=c[1];e[2]=c[2];e[3]=c[3];e[4]=c[4];e[5]=c[5];e[6]=c[6];e[7]=c[7];e[8]=c[8];return e};d.mat3.transpose=function(c,e){if(!e||c===e){var f=
c[1],d=c[2],h=c[5];c[1]=c[3];c[2]=c[6];c[3]=f;c[5]=c[7];c[6]=d;c[7]=h;return c}e[0]=c[0];e[1]=c[3];e[2]=c[6];e[3]=c[1];e[4]=c[4];e[5]=c[7];e[6]=c[2];e[7]=c[5];e[8]=c[8];return e};d.mat3.toMat4=function(c,e){e||(e=d.mat4.create());e[15]=1;e[14]=0;e[13]=0;e[12]=0;e[11]=0;e[10]=c[8];e[9]=c[7];e[8]=c[6];e[7]=0;e[6]=c[5];e[5]=c[4];e[4]=c[3];e[3]=0;e[2]=c[2];e[1]=c[1];e[0]=c[0];return e};d.mat4.create=function(){var c=new d.Matrix(16);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=
0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.mat4.transpose=function(c,e){if(!e||c===e){var f=c[1],d=c[2],h=c[3],l=c[6],m=c[7],n=c[11];c[1]=c[4];c[2]=c[8];c[3]=c[12];c[4]=f;c[6]=c[9];c[7]=c[13];c[8]=d;c[9]=l;c[11]=c[14];c[12]=h;c[13]=m;c[14]=n;return c}e[0]=c[0];e[1]=c[4];e[2]=c[8];e[3]=c[12];e[4]=c[1];e[5]=c[5];e[6]=c[9];e[7]=c[13];e[8]=c[2];e[9]=c[6];e[10]=c[10];e[11]=c[14];e[12]=c[3];e[13]=c[7];e[14]=c[11];e[15]=c[15];return e};d.mat4.multiply=function(c,e,f){f||(f=c);var d=c[0],
h=c[1],l=c[2],m=c[3],n=c[4],s=c[5],q=c[6],u=c[7],p=c[8],t=c[9],v=c[10],z=c[11],x=c[12],D=c[13],A=c[14];c=c[15];var w=e[0],B=e[1],E=e[2],F=e[3];f[0]=w*d+B*n+E*p+F*x;f[1]=w*h+B*s+E*t+F*D;f[2]=w*l+B*q+E*v+F*A;f[3]=w*m+B*u+E*z+F*c;w=e[4];B=e[5];E=e[6];F=e[7];f[4]=w*d+B*n+E*p+F*x;f[5]=w*h+B*s+E*t+F*D;f[6]=w*l+B*q+E*v+F*A;f[7]=w*m+B*u+E*z+F*c;w=e[8];B=e[9];E=e[10];F=e[11];f[8]=w*d+B*n+E*p+F*x;f[9]=w*h+B*s+E*t+F*D;f[10]=w*l+B*q+E*v+F*A;f[11]=w*m+B*u+E*z+F*c;w=e[12];B=e[13];E=e[14];F=e[15];f[12]=w*d+B*n+
E*p+F*x;f[13]=w*h+B*s+E*t+F*D;f[14]=w*l+B*q+E*v+F*A;f[15]=w*m+B*u+E*z+F*c;return f};d.DisplayObject=function(){this.last=this;this.first=this;this.position=new d.Point;this.scale=new d.Point(1,1);this.pivot=new d.Point(0,0);this.rotation=0;this.alpha=1;this.visible=!0;this.hitArea=null;this.renderable=this.buttonMode=!1;this.stage=this.parent=null;this.worldAlpha=1;this._interactive=!1;this.defaultCursor="pointer";this.worldTransform=d.mat3.create();this.localTransform=d.mat3.create();this.color=
[];this.dynamic=!0;this._sr=0;this._cr=1;this.filterArea=new d.Rectangle(0,0,1,1)};d.DisplayObject.prototype.constructor=d.DisplayObject;d.DisplayObject.prototype.setInteractive=function(c){this.interactive=c};Object.defineProperty(d.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(c){this._interactive=c;this.stage&&(this.stage.dirty=!0)}});Object.defineProperty(d.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(c){c?this._mask?
(c.start=this._mask.start,c.end=this._mask.end):(this.addFilter(c),c.renderable=!1):(this.removeFilter(this._mask),this._mask.renderable=!0);this._mask=c}});Object.defineProperty(d.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(c){if(c){this._filters&&this.removeFilter(this._filters);this.addFilter(c);for(var e=[],f=0;f<c.length;f++)for(var d=c[f].passes,h=0;h<d.length;h++)e.push(d[h]);c.start.filterPasses=e}else this._filters&&this.removeFilter(this._filters);
this._filters=c}});d.DisplayObject.prototype.addFilter=function(c){var e=new d.FilterBlock,f=new d.FilterBlock;c.start=e;c.end=f;e.data=c;f.data=c;e.first=e.last=this;f.first=f.last=this;e.open=!0;e.target=this;var k=c=e,h,l;(l=this.first._iPrev)?(h=l._iNext,c._iPrev=l,l._iNext=c):h=this;h&&(h._iPrev=k,k._iNext=h);k=c=f;l=this.last;if(h=l._iNext)h._iPrev=k,k._iNext=h;c._iPrev=l;l._iNext=c;c=this;for(k=this.last;c;)c.last===k&&(c.last=f),c=c.parent;this.first=e;this.__renderGroup&&this.__renderGroup.addFilterBlocks(e,
f)};d.DisplayObject.prototype.removeFilter=function(c){var e=c.start,f=e._iNext,d=e._iPrev;f&&(f._iPrev=d);d&&(d._iNext=f);this.first=e._iNext;c=c.end;f=c._iNext;d=c._iPrev;f&&(f._iPrev=d);d._iNext=f;f=c._iPrev;for(d=this;d.last===c&&(d.last=f,d=d.parent,d););this.__renderGroup&&this.__renderGroup.removeFilterBlocks(e,c)};d.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));
var c=this.localTransform,e=this.parent.worldTransform,f=this.worldTransform;c[0]=this._cr*this.scale.x;c[1]=-this._sr*this.scale.y;c[3]=this._sr*this.scale.x;c[4]=this._cr*this.scale.y;var k=this.pivot.x,h=this.pivot.y,l=c[0],m=c[1],n=this.position.x-c[0]*k-h*c[1],s=c[3],q=c[4],k=this.position.y-c[4]*h-k*c[3],h=e[0],u=e[1],p=e[2],t=e[3],v=e[4],e=e[5];c[2]=n;c[5]=k;f[0]=h*l+u*s;f[1]=h*m+u*q;f[2]=h*n+u*k+p;f[3]=t*l+v*s;f[4]=t*m+v*q;f[5]=t*n+v*k+e;this.worldAlpha=this.alpha*this.parent.worldAlpha;this.vcount=
d.visibleCount};d.visibleCount=0;d.DisplayObjectContainer=function(){d.DisplayObject.call(this);this.children=[]};d.DisplayObjectContainer.prototype=Object.create(d.DisplayObject.prototype);d.DisplayObjectContainer.prototype.constructor=d.DisplayObjectContainer;d.DisplayObjectContainer.prototype.addChild=function(c){c.parent&&c.parent!==this&&c.parent.removeChild(c);c.parent=this;this.children.push(c);if(this.stage){var e=c;do e.interactive&&(this.stage.dirty=!0),e.stage=this.stage,e=e._iNext;while(e)}var e=
c.first,f=c.last,d,h;h=this._filters||this._mask?this.last._iPrev:this.last;d=h._iNext;for(var l=this;l;)l.last===h&&(l.last=c.last),l=l.parent;d&&(d._iPrev=f,f._iNext=d);e._iPrev=h;h._iNext=e;this.__renderGroup&&(c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c),this.__renderGroup.addDisplayObjectAndChildren(c))};d.DisplayObjectContainer.prototype.addChildAt=function(c,e){if(0<=e&&e<=this.children.length){void 0!==c.parent&&c.parent.removeChild(c);c.parent=this;if(this.stage){var f=
c;do f.interactive&&(this.stage.dirty=!0),f.stage=this.stage,f=f._iNext;while(f)}var f=c.first,d=c.last,h,l;if(e===this.children.length){l=this.last;h=this;for(var m=this.last;h;)h.last===m&&(h.last=c.last),h=h.parent}else l=0===e?this:this.children[e-1].last;if(h=l._iNext)h._iPrev=d,d._iNext=h;f._iPrev=l;l._iNext=f;this.children.splice(e,0,c);this.__renderGroup&&(c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c),this.__renderGroup.addDisplayObjectAndChildren(c))}else throw Error(c+
" The index "+e+" supplied is out of bounds "+this.children.length);};d.DisplayObjectContainer.prototype.swapChildren=function(c,e){if(c!==e){var f=this.children.indexOf(c),d=this.children.indexOf(e);if(0>f||0>d)throw Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.removeChild(c);this.removeChild(e);f<d?(this.addChildAt(e,f),this.addChildAt(c,d)):(this.addChildAt(c,d),this.addChildAt(e,f))}};d.DisplayObjectContainer.prototype.getChildAt=function(c){if(0<=
c&&c<this.children.length)return this.children[c];throw Error("Both the supplied DisplayObjects must be a child of the caller "+this);};d.DisplayObjectContainer.prototype.removeChild=function(c){var e=this.children.indexOf(c);if(-1!==e){var f=c.first,d=c.last,h=d._iNext,l=f._iPrev;h&&(h._iPrev=l);l._iNext=h;if(this.last===d)for(h=f._iPrev,l=this;l.last===d&&(l.last=h,l=l.parent,l););d._iNext=null;f._iPrev=null;if(this.stage){f=c;do f.interactive&&(this.stage.dirty=!0),f.stage=null,f=f._iNext;while(f)}c.__renderGroup&&
c.__renderGroup.removeDisplayObjectAndChildren(c);c.parent=void 0;this.children.splice(e,1)}else throw Error(c+" The supplied DisplayObject must be a child of the caller "+this);};d.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){d.DisplayObject.prototype.updateTransform.call(this);for(var c=0,e=this.children.length;c<e;c++)this.children[c].updateTransform()}};d.blendModes={};d.blendModes.NORMAL=0;d.blendModes.SCREEN=1;d.Sprite=function(c){d.DisplayObjectContainer.call(this);
this.anchor=new d.Point;this.texture=c;this.blendMode=d.blendModes.NORMAL;this._height=this._width=0;c.baseTexture.hasLoaded?this.updateFrame=!0:(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind));this.renderable=!0};d.Sprite.prototype=Object.create(d.DisplayObjectContainer.prototype);d.Sprite.prototype.constructor=d.Sprite;Object.defineProperty(d.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},
set:function(c){this.scale.x=c/this.texture.frame.width;this._width=c}});Object.defineProperty(d.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(c){this.scale.y=c/this.texture.frame.height;this._height=c}});d.Sprite.prototype.setTexture=function(c){this.texture.baseTexture!==c.baseTexture?(this.textureChange=!0,this.texture=c,this.__renderGroup&&this.__renderGroup.updateTexture(this)):this.texture=c;this.updateFrame=!0};d.Sprite.prototype.onTextureUpdate=
function(){this._width&&(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=this._height/this.texture.frame.height);this.updateFrame=!0};d.Sprite.fromFrame=function(c){var e=d.TextureCache[c];if(!e)throw Error('The frameId "'+c+'" does not exist in the texture cache'+this);return new d.Sprite(e)};d.Sprite.fromImage=function(c){c=d.Texture.fromImage(c);return new d.Sprite(c)};d.MovieClip=function(c){d.Sprite.call(this,c[0]);this.textures=c;this.animationSpeed=1;this.loop=
!0;this.onComplete=null;this.currentFrame=0;this.playing=!1};d.MovieClip.prototype=Object.create(d.Sprite.prototype);d.MovieClip.prototype.constructor=d.MovieClip;Object.defineProperty(d.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}});d.MovieClip.prototype.stop=function(){this.playing=!1};d.MovieClip.prototype.play=function(){this.playing=!0};d.MovieClip.prototype.gotoAndStop=function(c){this.playing=!1;this.currentFrame=c;this.setTexture(this.textures[(this.currentFrame+
0.5|0)%this.textures.length])};d.MovieClip.prototype.gotoAndPlay=function(c){this.currentFrame=c;this.playing=!0};d.MovieClip.prototype.updateTransform=function(){d.Sprite.prototype.updateTransform.call(this);if(this.playing){this.currentFrame+=this.animationSpeed;var c=this.currentFrame+0.5|0;if(this.loop||c<this.textures.length)this.setTexture(this.textures[c%this.textures.length]);else if(c>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete))this.onComplete()}};d.FilterBlock=
function(){this.renderable=this.visible=!0};d.Text=function(c,e){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");d.Sprite.call(this,d.Texture.fromCanvas(this.canvas));this.setText(c);this.setStyle(e);this.updateText();this.dirty=!1};d.Text.prototype=Object.create(d.Sprite.prototype);d.Text.prototype.constructor=d.Text;d.Text.prototype.setStyle=function(c){c=c||{};c.font=c.font||"bold 20pt Arial";c.fill=c.fill||"black";c.align=c.align||"left";c.stroke=c.stroke||
"black";c.strokeThickness=c.strokeThickness||0;c.wordWrap=c.wordWrap||!1;c.wordWrapWidth=c.wordWrapWidth||100;this.style=c;this.dirty=!0};d.Text.prototype.setText=function(c){this.text=c.toString()||" ";this.dirty=!0};d.Text.prototype.updateText=function(){this.context.font=this.style.font;var c=this.text;this.style.wordWrap&&(c=this.wordWrap(this.text));for(var c=c.split(/(?:\r\n|\r|\n)/),e=[],f=0,k=0;k<c.length;k++){var h=this.context.measureText(c[k]).width;e[k]=h;f=Math.max(f,h)}this.canvas.width=
f+this.style.strokeThickness;h=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness;this.canvas.height=h*c.length;this.context.fillStyle=this.style.fill;this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.lineWidth=this.style.strokeThickness;this.context.textBaseline="top";for(k=0;k<c.length;k++){var l=new d.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+k*h);"right"===this.style.align?l.x+=f-e[k]:"center"===this.style.align&&
(l.x+=(f-e[k])/2);this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(c[k],l.x,l.y);this.style.fill&&this.context.fillText(c[k],l.x,l.y)}this.updateTexture()};d.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width;this.texture.baseTexture.height=this.canvas.height;this.texture.frame.width=this.canvas.width;this.texture.frame.height=this.canvas.height;this._width=this.canvas.width;this._height=this.canvas.height;d.texturesToUpdate.push(this.texture.baseTexture)};
d.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1);d.Sprite.prototype.updateTransform.call(this)};d.Text.prototype.determineFontHeight=function(c){var e=d.Text.heightCache[c];if(!e){var f=document.getElementsByTagName("body")[0],k=document.createElement("div"),e=document.createTextNode("M");k.appendChild(e);k.setAttribute("style",c+";position:absolute;top:0;left:0");f.appendChild(k);e=k.offsetHeight;d.Text.heightCache[c]=e;f.removeChild(k)}return e};d.Text.prototype.wordWrap=
function(c){var e="";c=c.split("\n");for(var f=0;f<c.length;f++){for(var d=this.style.wordWrapWidth,h=c[f].split(" "),l=0;l<h.length;l++){var m=this.context.measureText(h[l]).width,n=m+this.context.measureText(" ").width;n>d?(0<l&&(e+="\n"),e+=h[l]+" ",d=this.style.wordWrapWidth-m):(d-=n,e+=h[l]+" ")}e+="\n"}return e};d.Text.prototype.destroy=function(c){c&&this.texture.destroy()};d.Text.heightCache={};d.BitmapText=function(c,e){d.DisplayObjectContainer.call(this);this.setText(c);this.setStyle(e);
this.updateText();this.dirty=!1};d.BitmapText.prototype=Object.create(d.DisplayObjectContainer.prototype);d.BitmapText.prototype.constructor=d.BitmapText;d.BitmapText.prototype.setText=function(c){this.text=c||" ";this.dirty=!0};d.BitmapText.prototype.setStyle=function(c){c=c||{};c.align=c.align||"left";this.style=c;c=c.font.split(" ");this.fontName=c[c.length-1];this.fontSize=2<=c.length?parseInt(c[c.length-2],10):d.BitmapText.fonts[this.fontName].size;this.dirty=!0};d.BitmapText.prototype.updateText=
function(){for(var c=d.BitmapText.fonts[this.fontName],e=new d.Point,f=null,k=[],h=0,l=[],m=0,n=this.fontSize/c.size,s=0;s<this.text.length;s++){var q=this.text.charCodeAt(s);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(s)))l.push(e.x),h=Math.max(h,e.x),m++,e.x=0,e.y+=c.lineHeight,f=null;else{var u=c.chars[q];u&&(f&&u[f]&&(e.x+=u.kerning[f]),k.push({texture:u.texture,line:m,charCode:q,position:new d.Point(e.x+u.xOffset,e.y+u.yOffset)}),e.x+=u.xAdvance,f=q)}}l.push(e.x);h=Math.max(h,e.x);f=[];for(s=0;s<=
m;s++)q=0,"right"===this.style.align?q=h-l[s]:"center"===this.style.align&&(q=(h-l[s])/2),f.push(q);for(s=0;s<k.length;s++)l=new d.Sprite(k[s].texture),l.position.x=(k[s].position.x+f[k[s].line])*n,l.position.y=k[s].position.y*n,l.scale.x=l.scale.y=n,this.addChild(l);this.width=h*n;this.height=(e.y+c.lineHeight)*n};d.BitmapText.prototype.updateTransform=function(){if(this.dirty){for(;0<this.children.length;)this.removeChild(this.getChildAt(0));this.updateText();this.dirty=!1}d.DisplayObjectContainer.prototype.updateTransform.call(this)};
d.BitmapText.fonts={};d.InteractionManager=function(c){this.stage=c;this.mouse=new d.InteractionData;this.touchs={};this.tempPoint=new d.Point;this.mouseoverEnabled=!0;this.pool=[];this.interactiveItems=[];this.interactionDOMElement=null;this.onMouseMove=this.onMouseMove.bind(this);this.onMouseDown=this.onMouseDown.bind(this);this.onMouseOut=this.onMouseOut.bind(this);this.onMouseUp=this.onMouseUp.bind(this);this.onTouchStart=this.onTouchStart.bind(this);this.onTouchEnd=this.onTouchEnd.bind(this);
this.onTouchMove=this.onTouchMove.bind(this);this.last=0};d.InteractionManager.prototype.constructor=d.InteractionManager;d.InteractionManager.prototype.collectInteractiveSprite=function(c,e){for(var f=c.children,d=f.length-1;0<=d;d--){var h=f[d];h.interactive?(e.interactiveChildren=!0,this.interactiveItems.push(h),0<h.children.length&&this.collectInteractiveSprite(h,h)):(h.__iParent=null,0<h.children.length&&this.collectInteractiveSprite(h,e))}};d.InteractionManager.prototype.setTarget=function(c){this.target=
c;null===this.interactionDOMElement&&this.setTargetDomElement(c.view);document.body.addEventListener("mouseup",this.onMouseUp,!0)};d.InteractionManager.prototype.setTargetDomElement=function(c){null!==this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,
!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0));window.navigator.msPointerEnabled&&(c.style["-ms-content-zooming"]="none",c.style["-ms-touch-action"]="none");this.interactionDOMElement=c;c.addEventListener("mousemove",this.onMouseMove,
!0);c.addEventListener("mousedown",this.onMouseDown,!0);c.addEventListener("mouseout",this.onMouseOut,!0);c.addEventListener("touchstart",this.onTouchStart,!0);c.addEventListener("touchend",this.onTouchEnd,!0);c.addEventListener("touchmove",this.onTouchMove,!0)};d.InteractionManager.prototype.update=function(){if(this.target){var c=Date.now(),e=c-this.last;if(!(1>30*e/1E3)){this.last=c;c=0;if(this.dirty){this.dirty=!1;e=this.interactiveItems.length;for(c=0;c<e;c++)this.interactiveItems[c].interactiveChildren=
!1;this.interactiveItems=[];this.stage.interactive&&this.interactiveItems.push(this.stage);this.collectInteractiveSprite(this.stage,this.stage)}e=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(c=0;c<e;c++){var f=this.interactiveItems[c];if(f.mouseover||f.mouseout||f.buttonMode)f.__hit=this.hitTest(f,this.mouse),this.mouse.target=f,f.__hit?(f.buttonMode&&(this.interactionDOMElement.style.cursor=f.defaultCursor),f.__isOver||(f.mouseover&&f.mouseover(this.mouse),f.__isOver=
!0)):f.__isOver&&(f.mouseout&&f.mouseout(this.mouse),f.__isOver=!1)}}}};d.InteractionManager.prototype.onMouseMove=function(c){this.mouse.originalEvent=c||window.event;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(c.clientX-e.left)*(this.target.width/e.width);this.mouse.global.y=(c.clientY-e.top)*(this.target.height/e.height);c=this.interactiveItems.length;for(e=0;e<c;e++){var f=this.interactiveItems[e];f.mousemove&&f.mousemove(this.mouse)}};d.InteractionManager.prototype.onMouseDown=
function(c){this.mouse.originalEvent=c||window.event;c=this.interactiveItems.length;for(var e=0;e<c;e++){var f=this.interactiveItems[e];if(f.mousedown||f.click)if(f.__mouseIsDown=!0,f.__hit=this.hitTest(f,this.mouse),f.__hit&&(f.mousedown&&f.mousedown(this.mouse),f.__isDown=!0,!f.interactiveChildren))break}};d.InteractionManager.prototype.onMouseOut=function(){var c=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var e=0;e<c;e++){var f=this.interactiveItems[e];f.__isOver&&
(this.mouse.target=f,f.mouseout&&f.mouseout(this.mouse),f.__isOver=!1)}};d.InteractionManager.prototype.onMouseUp=function(c){this.mouse.originalEvent=c||window.event;c=this.interactiveItems.length;for(var e=!1,f=0;f<c;f++){var d=this.interactiveItems[f];if(d.mouseup||d.mouseupoutside||d.click)d.__hit=this.hitTest(d,this.mouse),d.__hit&&!e?(d.mouseup&&d.mouseup(this.mouse),d.__isDown&&d.click&&d.click(this.mouse),d.interactiveChildren||(e=!0)):d.__isDown&&d.mouseupoutside&&d.mouseupoutside(this.mouse),
d.__isDown=!1}};d.InteractionManager.prototype.hitTest=function(c,e){var f=e.global;if(c.vcount!==d.visibleCount)return!1;var k=c instanceof d.Sprite,h=c.worldTransform,l=h[0],m=h[1],n=h[2],s=h[3],q=h[4],h=h[5],u=1/(l*q+m*-s),m=q*u*f.x+-m*u*f.y+(h*m-n*q)*u,f=l*u*f.y+-s*u*f.x+(-h*l+n*s)*u;e.target=c;if(c.hitArea&&c.hitArea.contains)return c.hitArea.contains(m,f)?(e.target=c,!0):!1;if(k&&(l=c.texture.frame.width,k=c.texture.frame.height,n=-l*c.anchor.x,m>n&&m<n+l&&(m=-k*c.anchor.y,f>m&&f<m+k)))return e.target=
c,!0;k=c.children.length;for(m=0;m<k;m++)if(this.hitTest(c.children[m],e))return e.target=c,!0;return!1};d.InteractionManager.prototype.onTouchMove=function(c){for(var e=this.interactionDOMElement.getBoundingClientRect(),f=c.changedTouches,d,h=0,h=0;h<f.length;h++){var l=f[h];d=this.touchs[l.identifier];d.originalEvent=c||window.event;d.global.x=(l.clientX-e.left)*(this.target.width/e.width);d.global.y=(l.clientY-e.top)*(this.target.height/e.height)}c=this.interactiveItems.length;for(h=0;h<c;h++)e=
this.interactiveItems[h],e.touchmove&&e.touchmove(d)};d.InteractionManager.prototype.onTouchStart=function(c){for(var e=this.interactionDOMElement.getBoundingClientRect(),f=c.changedTouches,k=0;k<f.length;k++){var h=f[k],l=this.pool.pop();l||(l=new d.InteractionData);l.originalEvent=c||window.event;this.touchs[h.identifier]=l;l.global.x=(h.clientX-e.left)*(this.target.width/e.width);l.global.y=(h.clientY-e.top)*(this.target.height/e.height);for(var h=this.interactiveItems.length,m=0;m<h;m++){var n=
this.interactiveItems[m];if(n.touchstart||n.tap)if(n.__hit=this.hitTest(n,l),n.__hit&&(n.touchstart&&n.touchstart(l),n.__isDown=!0,n.__touchData=l,!n.interactiveChildren))break}}};d.InteractionManager.prototype.onTouchEnd=function(c){for(var e=this.interactionDOMElement.getBoundingClientRect(),f=c.changedTouches,d=0;d<f.length;d++){var h=f[d],l=this.touchs[h.identifier],m=!1;l.global.x=(h.clientX-e.left)*(this.target.width/e.width);l.global.y=(h.clientY-e.top)*(this.target.height/e.height);for(var n=
this.interactiveItems.length,s=0;s<n;s++){var q=this.interactiveItems[s],u=q.__touchData;q.__hit=this.hitTest(q,l);if(u===l){l.originalEvent=c||window.event;if(q.touchend||q.tap)q.__hit&&!m?(q.touchend&&q.touchend(l),q.__isDown&&q.tap&&q.tap(l),q.interactiveChildren||(m=!0)):q.__isDown&&q.touchendoutside&&q.touchendoutside(l),q.__isDown=!1;q.__touchData=null}}this.pool.push(l);this.touchs[h.identifier]=null}};d.InteractionData=function(){this.global=new d.Point;this.local=new d.Point;this.originalEvent=
this.target=null};d.InteractionData.prototype.getLocalPosition=function(c){var e=c.worldTransform;c=this.global;var f=e[0],k=e[1],h=e[2],l=e[3],m=e[4],e=e[5],n=1/(f*m+k*-l);return new d.Point(m*n*c.x+-k*n*c.y+(e*k-h*m)*n,f*n*c.y+-l*n*c.x+(-e*f+h*l)*n)};d.InteractionData.prototype.constructor=d.InteractionData;d.Stage=function(c){d.DisplayObjectContainer.call(this);this.worldTransform=d.mat3.create();this.interactive=!0;this.interactionManager=new d.InteractionManager(this);this.dirty=!0;this.__childrenAdded=
[];this.__childrenRemoved=[];this.stage=this;this.stage.hitArea=new d.Rectangle(0,0,1E5,1E5);this.setBackgroundColor(c);this.worldVisible=!0};d.Stage.prototype=Object.create(d.DisplayObjectContainer.prototype);d.Stage.prototype.constructor=d.Stage;d.Stage.prototype.setInteractionDelegate=function(c){this.interactionManager.setTargetDomElement(c)};d.Stage.prototype.updateTransform=function(){this.worldAlpha=1;this.vcount=d.visibleCount;for(var c=0,e=this.children.length;c<e;c++)this.children[c].updateTransform();
this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0);this.interactive&&this.interactionManager.update()};d.Stage.prototype.setBackgroundColor=function(c){this.backgroundColor=c||0;this.backgroundColorSplit=d.hex2rgb(this.backgroundColor);c=this.backgroundColor.toString(16);c="000000".substr(0,6-c.length)+c;this.backgroundColorString="#"+c};d.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var M=0,K=["ms","moz","webkit","o"],J=0;J<K.length&&!window.requestAnimationFrame;++J)window.requestAnimationFrame=
window[K[J]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[K[J]+"CancelAnimationFrame"]||window[K[J]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c){var e=(new Date).getTime(),f=Math.max(0,16-(e-M)),d=window.setTimeout(function(){c(e+f)},f);M=e+f;return d});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(c){clearTimeout(c)});window.requestAnimFrame=window.requestAnimationFrame;d.hex2rgb=function(c){return[(c>>16&
255)/255,(c>>8&255)/255,(c&255)/255]};"function"!==typeof Function.prototype.bind&&(Function.prototype.bind=function(){var c=Array.prototype.slice;return function(e){function f(){var l=h.concat(c.call(arguments));d.apply(this instanceof f?this:e,l)}var d=this,h=c.call(arguments,1);if("function"!==typeof d)throw new TypeError;f.prototype=function m(c){c&&(m.prototype=c);if(!(this instanceof m))return new m}(d.prototype);return f}}());d.AjaxRequest=function(){var c=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0",
"Microsoft.XMLHTTP"];if(window.ActiveXObject)for(var e=0;e<c.length;e++)try{return new window.ActiveXObject(c[e])}catch(f){}else return window.XMLHttpRequest?new window.XMLHttpRequest:!1};d.runList=function(c){window.console.log(">>>>>>>>>");window.console.log("_");var e=0;c=c.first;for(window.console.log(c);c._iNext;)if(e++,c=c._iNext,window.console.log(c),100<e){window.console.log("BREAK");break}};d.EventTarget=function(){var c={};this.addEventListener=this.on=function(e,f){void 0===c[e]&&(c[e]=
[]);-1===c[e].indexOf(f)&&c[e].push(f)};this.dispatchEvent=this.emit=function(e){if(c[e.type]&&c[e.type].length)for(var f=0,d=c[e.type].length;f<d;f++)c[e.type][f](e)};this.removeEventListener=this.off=function(e,f){var d=c[e].indexOf(f);-1!==d&&c[e].splice(d,1)};this.removeAllEventListeners=function(e){if(e=c[e])e.length=0}};d.autoDetectRenderer=function(c,e,f,k,h){c||(c=800);e||(e=600);var l;try{var m=document.createElement("canvas");l=!!window.WebGLRenderingContext&&(m.getContext("webgl")||m.getContext("experimental-webgl"))}catch(n){l=
!1}l&&(l=-1===navigator.userAgent.toLowerCase().indexOf("trident"));return l?new d.WebGLRenderer(c,e,f,k,h):new d.CanvasRenderer(c,e,f,k)};d.PolyK={};d.PolyK.Triangulate=function(c){var e=!0,f=c.length>>1;if(3>f)return[];for(var k=[],h=[],l=0;l<f;l++)h.push(l);for(var l=0,m=f;3<m;){var n=h[(l+0)%m],s=h[(l+1)%m],q=h[(l+2)%m],u=c[2*n],p=c[2*n+1],t=c[2*s],v=c[2*s+1],z=c[2*q],x=c[2*q+1],D=!1;if(d.PolyK._convex(u,p,t,v,z,x,e))for(var D=!0,A=0;A<m;A++){var w=h[A];if(w!==n&&(w!==s&&w!==q)&&d.PolyK._PointInTriangle(c[2*
w],c[2*w+1],u,p,t,v,z,x)){D=!1;break}}if(D)k.push(n,s,q),h.splice((l+1)%m,1),m--,l=0;else if(l++>3*m)if(e){k=[];h=[];for(l=0;l<f;l++)h.push(l);l=0;m=f;e=!1}else return window.console.log("PIXI Warning: shape too complex to fill"),[]}k.push(h[0],h[1],h[2]);return k};d.PolyK._PointInTriangle=function(c,e,f,d,h,l,m,n){m-=f;n-=d;h-=f;l-=d;c-=f;f=e-d;e=m*m+n*n;d=m*h+n*l;m=m*c+n*f;n=h*h+l*l;h=h*c+l*f;l=1/(e*n-d*d);n=(n*m-d*h)*l;m=(e*h-d*m)*l;return 0<=n&&0<=m&&1>n+m};d.PolyK._convex=function(c,e,f,d,h,
l,m){return 0<=(e-d)*(h-f)+(f-c)*(l-d)===m};d.initDefaultShaders=function(){d.primitiveShader=new d.PrimitiveShader;d.primitiveShader.init();d.stripShader=new d.StripShader;d.stripShader.init();d.defaultShader=new d.PixiShader;d.defaultShader.init();var c=d.gl;c.useProgram(d.defaultShader.program);c.enableVertexAttribArray(d.defaultShader.aVertexPosition);c.enableVertexAttribArray(d.defaultShader.colorAttribute);c.enableVertexAttribArray(d.defaultShader.aTextureCoord)};d.activatePrimitiveShader=function(){var c=
d.gl;c.useProgram(d.primitiveShader.program);c.disableVertexAttribArray(d.defaultShader.aVertexPosition);c.disableVertexAttribArray(d.defaultShader.colorAttribute);c.disableVertexAttribArray(d.defaultShader.aTextureCoord);c.enableVertexAttribArray(d.primitiveShader.aVertexPosition);c.enableVertexAttribArray(d.primitiveShader.colorAttribute)};d.deactivatePrimitiveShader=function(){var c=d.gl;c.useProgram(d.defaultShader.program);c.disableVertexAttribArray(d.primitiveShader.aVertexPosition);c.disableVertexAttribArray(d.primitiveShader.colorAttribute);
c.enableVertexAttribArray(d.defaultShader.aVertexPosition);c.enableVertexAttribArray(d.defaultShader.colorAttribute);c.enableVertexAttribArray(d.defaultShader.aTextureCoord)};d.activateStripShader=function(){d.gl.useProgram(d.stripShader.program)};d.deactivateStripShader=function(){d.gl.useProgram(d.defaultShader.program)};d.CompileVertexShader=function(c,e){return d._CompileShader(c,e,c.VERTEX_SHADER)};d.CompileFragmentShader=function(c,e){return d._CompileShader(c,e,c.FRAGMENT_SHADER)};d._CompileShader=
function(c,e,f){e=e.join("\n");f=c.createShader(f);c.shaderSource(f,e);c.compileShader(f);return c.getShaderParameter(f,c.COMPILE_STATUS)?f:(window.console.log(c.getShaderInfoLog(f)),null)};d.compileProgram=function(c,e){var f=d.gl,k=d.CompileFragmentShader(f,e),h=d.CompileVertexShader(f,c),l=f.createProgram();f.attachShader(l,h);f.attachShader(l,k);f.linkProgram(l);f.getProgramParameter(l,f.LINK_STATUS)||window.console.log("Could not initialise shaders");return l};d.PixiShader=function(){this.program=
null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;","}"];this.textureCount=0};d.PixiShader.prototype.init=function(){var c=d.compileProgram(this.vertexSrc||d.PixiShader.defaultVertexSrc,this.fragmentSrc),e=d.gl;e.useProgram(c);this.uSampler=e.getUniformLocation(c,"uSampler");this.projectionVector=e.getUniformLocation(c,"projectionVector");
this.offsetVector=e.getUniformLocation(c,"offsetVector");this.dimensions=e.getUniformLocation(c,"dimensions");this.aVertexPosition=e.getAttribLocation(c,"aVertexPosition");this.colorAttribute=e.getAttribLocation(c,"aColor");this.aTextureCoord=e.getAttribLocation(c,"aTextureCoord");for(var f in this.uniforms)this.uniforms[f].uniformLocation=e.getUniformLocation(c,f);this.initUniforms();this.program=c};d.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var c,e;for(e in this.uniforms){c=
this.uniforms[e];var f=c.type;"sampler2D"===f?(c._init=!1,null!==c.value&&this.initSampler2D(c)):"mat2"===f||"mat3"===f||"mat4"===f?(c.glMatrix=!0,c.glValueLength=1,"mat2"===f?c.glFunc=d.gl.uniformMatrix2fv:"mat3"===f?c.glFunc=d.gl.uniformMatrix3fv:"mat4"===f&&(c.glFunc=d.gl.uniformMatrix4fv)):(c.glFunc=d.gl["uniform"+f],c.glValueLength="2f"===f||"2i"===f?2:"3f"===f||"3i"===f?3:"4f"===f||"4i"===f?4:1)}};d.PixiShader.prototype.initSampler2D=function(c){if(c.value&&c.value.baseTexture&&c.value.baseTexture.hasLoaded){d.gl.activeTexture(d.gl["TEXTURE"+
this.textureCount]);d.gl.bindTexture(d.gl.TEXTURE_2D,c.value.baseTexture._glTexture);if(c.textureData){var e=c.textureData,f=e.magFilter?e.magFilter:d.gl.LINEAR,k=e.minFilter?e.minFilter:d.gl.LINEAR,h=e.wrapS?e.wrapS:d.gl.CLAMP_TO_EDGE,l=e.wrapT?e.wrapT:d.gl.CLAMP_TO_EDGE,m=e.luminance?d.gl.LUMINANCE:d.gl.RGBA;e.repeat&&(l=h=d.gl.REPEAT);d.gl.pixelStorei(d.gl.UNPACK_FLIP_Y_WEBGL,!1);e.width?d.gl.texImage2D(d.gl.TEXTURE_2D,0,m,e.width?e.width:512,e.height?e.height:2,e.border?e.border:0,m,d.gl.UNSIGNED_BYTE,
null):d.gl.texImage2D(d.gl.TEXTURE_2D,0,m,d.gl.RGBA,d.gl.UNSIGNED_BYTE,c.value.baseTexture.source);d.gl.texParameteri(d.gl.TEXTURE_2D,d.gl.TEXTURE_MAG_FILTER,f);d.gl.texParameteri(d.gl.TEXTURE_2D,d.gl.TEXTURE_MIN_FILTER,k);d.gl.texParameteri(d.gl.TEXTURE_2D,d.gl.TEXTURE_WRAP_S,h);d.gl.texParameteri(d.gl.TEXTURE_2D,d.gl.TEXTURE_WRAP_T,l)}d.gl.uniform1i(c.uniformLocation,this.textureCount);c._init=!0;this.textureCount++}};d.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var c,e;for(e in this.uniforms)c=
this.uniforms[e],1===c.glValueLength?!0===c.glMatrix?c.glFunc.call(d.gl,c.uniformLocation,c.transpose,c.value):c.glFunc.call(d.gl,c.uniformLocation,c.value):2===c.glValueLength?c.glFunc.call(d.gl,c.uniformLocation,c.value.x,c.value.y):3===c.glValueLength?c.glFunc.call(d.gl,c.uniformLocation,c.value.x,c.value.y,c.value.z):4===c.glValueLength?c.glFunc.call(d.gl,c.uniformLocation,c.value.x,c.value.y,c.value.z,c.value.w):"sampler2D"===c.type&&(c._init?(d.gl.activeTexture(d.gl["TEXTURE"+this.textureCount]),
d.gl.bindTexture(d.gl.TEXTURE_2D,c.value.baseTexture._glTexture),d.gl.uniform1i(c.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(c))};d.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);",
"   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"];d.StripShader=function(){this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","   gl_FragColor = gl_FragColor * alpha;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;",
"uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","varying vec2 offsetVector;","varying float vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"]};d.StripShader.prototype.init=function(){var c=d.compileProgram(this.vertexSrc,
this.fragmentSrc),e=d.gl;e.useProgram(c);this.uSampler=e.getUniformLocation(c,"uSampler");this.projectionVector=e.getUniformLocation(c,"projectionVector");this.offsetVector=e.getUniformLocation(c,"offsetVector");this.colorAttribute=e.getAttribLocation(c,"aColor");this.aVertexPosition=e.getAttribLocation(c,"aVertexPosition");this.aTextureCoord=e.getAttribLocation(c,"aTextureCoord");this.translationMatrix=e.getUniformLocation(c,"translationMatrix");this.alpha=e.getUniformLocation(c,"alpha");this.program=
c};d.PrimitiveShader=function(){this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);",
"   vColor = aColor  * alpha;","}"]};d.PrimitiveShader.prototype.init=function(){var c=d.compileProgram(this.vertexSrc,this.fragmentSrc),e=d.gl;e.useProgram(c);this.projectionVector=e.getUniformLocation(c,"projectionVector");this.offsetVector=e.getUniformLocation(c,"offsetVector");this.aVertexPosition=e.getAttribLocation(c,"aVertexPosition");this.colorAttribute=e.getAttribLocation(c,"aColor");this.translationMatrix=e.getUniformLocation(c,"translationMatrix");this.alpha=e.getUniformLocation(c,"alpha");
this.program=c};d.WebGLGraphics=function(){};d.WebGLGraphics.renderGraphics=function(c,e){var f=d.gl;c._webGL||(c._webGL={points:[],indices:[],lastIndex:0,buffer:f.createBuffer(),indexBuffer:f.createBuffer()});c.dirty&&(c.dirty=!1,c.clearDirty&&(c.clearDirty=!1,c._webGL.lastIndex=0,c._webGL.points=[],c._webGL.indices=[]),d.WebGLGraphics.updateGraphics(c));d.activatePrimitiveShader();var k=d.mat3.clone(c.worldTransform);d.mat3.transpose(k);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.uniformMatrix3fv(d.primitiveShader.translationMatrix,
!1,k);f.uniform2f(d.primitiveShader.projectionVector,e.x,-e.y);f.uniform2f(d.primitiveShader.offsetVector,-d.offset.x,-d.offset.y);f.uniform1f(d.primitiveShader.alpha,c.worldAlpha);f.bindBuffer(f.ARRAY_BUFFER,c._webGL.buffer);f.vertexAttribPointer(d.primitiveShader.aVertexPosition,2,f.FLOAT,!1,24,0);f.vertexAttribPointer(d.primitiveShader.colorAttribute,4,f.FLOAT,!1,24,8);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c._webGL.indexBuffer);f.drawElements(f.TRIANGLE_STRIP,c._webGL.indices.length,f.UNSIGNED_SHORT,
0);d.deactivatePrimitiveShader()};d.WebGLGraphics.updateGraphics=function(c){for(var e=c._webGL.lastIndex;e<c.graphicsData.length;e++){var f=c.graphicsData[e];f.type===d.Graphics.POLY?(f.fill&&3<f.points.length&&d.WebGLGraphics.buildPoly(f,c._webGL),0<f.lineWidth&&d.WebGLGraphics.buildLine(f,c._webGL)):f.type===d.Graphics.RECT?d.WebGLGraphics.buildRectangle(f,c._webGL):f.type!==d.Graphics.CIRC&&f.type!==d.Graphics.ELIP||d.WebGLGraphics.buildCircle(f,c._webGL)}c._webGL.lastIndex=c.graphicsData.length;
e=d.gl;c._webGL.glPoints=new Float32Array(c._webGL.points);e.bindBuffer(e.ARRAY_BUFFER,c._webGL.buffer);e.bufferData(e.ARRAY_BUFFER,c._webGL.glPoints,e.STATIC_DRAW);c._webGL.glIndicies=new Uint16Array(c._webGL.indices);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c._webGL.indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,c._webGL.glIndicies,e.STATIC_DRAW)};d.WebGLGraphics.buildRectangle=function(c,e){var f=c.points,k=f[0],h=f[1],l=f[2],f=f[3];if(c.fill){var m=d.hex2rgb(c.fillColor),n=c.fillAlpha,s=m[0]*n,q=
m[1]*n,m=m[2]*n,u=e.points,p=e.indices,t=u.length/6;u.push(k,h);u.push(s,q,m,n);u.push(k+l,h);u.push(s,q,m,n);u.push(k,h+f);u.push(s,q,m,n);u.push(k+l,h+f);u.push(s,q,m,n);p.push(t,t,t+1,t+2,t+3,t+3)}c.lineWidth&&(c.points=[k,h,k+l,h,k+l,h+f,k,h+f,k,h],d.WebGLGraphics.buildLine(c,e))};d.WebGLGraphics.buildCircle=function(c,e){var f=c.points,k=f[0],h=f[1],l=f[2],f=f[3],m=2*Math.PI/40,n=0;if(c.fill){var n=d.hex2rgb(c.fillColor),s=c.fillAlpha,q=n[0]*s,u=n[1]*s,p=n[2]*s,t=e.points,v=e.indices,z=t.length/
6;v.push(z);for(n=0;41>n;n++)t.push(k,h,q,u,p,s),t.push(k+Math.sin(m*n)*l,h+Math.cos(m*n)*f,q,u,p,s),v.push(z++,z++);v.push(z-1)}if(c.lineWidth){c.points=[];for(n=0;41>n;n++)c.points.push(k+Math.sin(m*n)*l,h+Math.cos(m*n)*f);d.WebGLGraphics.buildLine(c,e)}};d.WebGLGraphics.buildLine=function(c,e){var f=0,k=c.points;if(0!==k.length){if(c.lineWidth%2)for(f=0;f<k.length;f++)k[f]+=0.5;var h=new d.Point(k[0],k[1]),l=new d.Point(k[k.length-2],k[k.length-1]);if(h.x===l.x&&h.y===l.y){k.pop();k.pop();var l=
new d.Point(k[k.length-2],k[k.length-1]),m=l.x+0.5*(h.x-l.x),h=l.y+0.5*(h.y-l.y);k.unshift(m,h);k.push(m,h)}var m=e.points,h=e.indices,l=k.length/2,n=k.length,s=m.length/6,q=c.lineWidth/2,f=d.hex2rgb(c.lineColor),p=c.lineAlpha,y=f[0]*p,t=f[1]*p,v=f[2]*p,z,x,D,A,w,B,E,F,C,G,H,I,J;D=k[0];A=k[1];w=k[2];B=k[3];C=-(A-B);G=D-w;x=Math.sqrt(C*C+G*G);C=C/x*q;G=G/x*q;m.push(D-C,A-G,y,t,v,p);m.push(D+C,A+G,y,t,v,p);for(f=1;f<l-1;f++)D=k[2*(f-1)],A=k[2*(f-1)+1],w=k[2*f],B=k[2*f+1],E=k[2*(f+1)],F=k[2*(f+1)+1],
C=-(A-B),G=D-w,x=Math.sqrt(C*C+G*G),C/=x,G/=x,C*=q,G*=q,H=-(B-F),I=w-E,x=Math.sqrt(H*H+I*I),H/=x,I/=x,H*=q,I*=q,x=-G+A-(-G+B),z=-C+w-(-C+D),D=(-C+D)*(-G+B)-(-C+w)*(-G+A),A=-I+F-(-I+B),J=-H+w-(-H+E),E=(-H+E)*(-I+B)-(-H+w)*(-I+F),F=x*J-A*z,0.1>Math.abs(F)?(m.push(w-C,B-G,y,t,v,p),m.push(w+C,B+G,y,t,v,p)):(z=(z*E-J*D)/F,x=(A*D-x*E)/F,E=(z-w)*(z-w)+(x-B)+(x-B),19600<E?(C-=H,G-=I,x=Math.sqrt(C*C+G*G),C/=x,G/=x,C*=q,G*=q,m.push(w-C,B-G),m.push(y,t,v,p),m.push(w+C,B+G),m.push(y,t,v,p),m.push(w-C,B-G),m.push(y,
t,v,p),n++):(m.push(z,x),m.push(y,t,v,p),m.push(w-(z-w),B-(x-B)),m.push(y,t,v,p)));D=k[2*(l-2)];A=k[2*(l-2)+1];w=k[2*(l-1)];B=k[2*(l-1)+1];C=-(A-B);G=D-w;x=Math.sqrt(C*C+G*G);C/=x;G/=x;C*=q;G*=q;m.push(w-C,B-G);m.push(y,t,v,p);m.push(w+C,B+G);m.push(y,t,v,p);h.push(s);for(f=0;f<n;f++)h.push(s++);h.push(s-1)}};d.WebGLGraphics.buildPoly=function(c,e){var f=c.points;if(!(6>f.length)){for(var k=e.points,h=e.indices,l=f.length/2,m=d.hex2rgb(c.fillColor),n=c.fillAlpha,s=m[0]*n,q=m[1]*n,m=m[2]*n,p=d.PolyK.Triangulate(f),
y=k.length/6,t=0,t=0;t<p.length;t+=3)h.push(p[t]+y),h.push(p[t]+y),h.push(p[t+1]+y),h.push(p[t+2]+y),h.push(p[t+2]+y);for(t=0;t<l;t++)k.push(f[2*t],f[2*t+1],s,q,m,n)}};d._defaultFrame=new d.Rectangle(0,0,1,1);d.gl=null;d.WebGLRenderer=function(c,e,f,k,h){this.transparent=!!k;this.width=c||800;this.height=e||600;this.view=f||document.createElement("canvas");this.view.width=this.width;this.view.height=this.height;var l=this;this.view.addEventListener("webglcontextlost",function(c){l.handleContextLost(c)},
!1);this.view.addEventListener("webglcontextrestored",function(c){l.handleContextRestored(c)},!1);this.batchs=[];c={alpha:this.transparent,antialias:!!h,premultipliedAlpha:!1,stencil:!0};try{d.gl=this.gl=this.view.getContext("experimental-webgl",c)}catch(m){try{d.gl=this.gl=this.view.getContext("webgl",c)}catch(n){throw Error(" This browser does not support webGL. Try using the canvas renderer"+this);}}d.initDefaultShaders();c=this.gl;c.useProgram(d.defaultShader.program);d.WebGLRenderer.gl=c;this.batch=
new d.WebGLBatch(c);c.disable(c.DEPTH_TEST);c.disable(c.CULL_FACE);c.enable(c.BLEND);c.colorMask(!0,!0,!0,this.transparent);d.projection=new d.Point(400,300);d.offset=new d.Point(0,0);this.resize(this.width,this.height);this.contextLost=!1;this.stageRenderGroup=new d.WebGLRenderGroup(this.gl,this.transparent)};d.WebGLRenderer.prototype.constructor=d.WebGLRenderer;d.WebGLRenderer.getBatch=function(){return 0===d._batchs.length?new d.WebGLBatch(d.WebGLRenderer.gl):d._batchs.pop()};d.WebGLRenderer.returnBatch=
function(c){c.clean();d._batchs.push(c)};d.WebGLRenderer.prototype.render=function(c){if(!this.contextLost){this.__stage!==c&&(this.__stage=c,this.stageRenderGroup.setRenderable(c));d.WebGLRenderer.updateTextures();d.visibleCount++;c.updateTransform();var e=this.gl;e.colorMask(!0,!0,!0,this.transparent);e.viewport(0,0,this.width,this.height);e.bindFramebuffer(e.FRAMEBUFFER,null);e.clearColor(c.backgroundColorSplit[0],c.backgroundColorSplit[1],c.backgroundColorSplit[2],!this.transparent);e.clear(e.COLOR_BUFFER_BIT);
this.stageRenderGroup.backgroundColor=c.backgroundColorSplit;d.projection.x=this.width/2;d.projection.y=-this.height/2;this.stageRenderGroup.render(d.projection);c.interactive&&!c._interactiveEventsAdded&&(c._interactiveEventsAdded=!0,c.interactionManager.setTarget(this));if(0<d.Texture.frameUpdates.length){for(c=0;c<d.Texture.frameUpdates.length;c++)d.Texture.frameUpdates[c].updateFrame=!1;d.Texture.frameUpdates=[]}}};d.WebGLRenderer.updateTextures=function(){for(var c=0,c=0;c<d.texturesToUpdate.length;c++)d.WebGLRenderer.updateTexture(d.texturesToUpdate[c]);
for(c=0;c<d.texturesToDestroy.length;c++)d.WebGLRenderer.destroyTexture(d.texturesToDestroy[c]);d.texturesToUpdate=[];d.texturesToDestroy=[]};d.WebGLRenderer.updateTexture=function(c){var e=d.gl;c._glTexture||(c._glTexture=e.createTexture());c.hasLoaded&&(e.bindTexture(e.TEXTURE_2D,c._glTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,c.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,c.scaleMode===d.BaseTexture.SCALE_MODE.LINEAR?
e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,c.scaleMode===d.BaseTexture.SCALE_MODE.LINEAR?e.LINEAR:e.NEAREST),c._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindTexture(e.TEXTURE_2D,null))};d.WebGLRenderer.destroyTexture=function(c){var e=d.gl;c._glTexture&&(c._glTexture=
e.createTexture(),e.deleteTexture(e.TEXTURE_2D,c._glTexture))};d.WebGLRenderer.prototype.resize=function(c,e){this.width=c;this.height=e;this.view.width=c;this.view.height=e;this.gl.viewport(0,0,this.width,this.height);d.projection.x=this.width/2;d.projection.y=-this.height/2};d.WebGLRenderer.prototype.handleContextLost=function(c){c.preventDefault();this.contextLost=!0};d.WebGLRenderer.prototype.handleContextRestored=function(){this.gl=this.view.getContext("experimental-webgl",{alpha:!0});this.initShaders();
for(var c in d.TextureCache){var e=d.TextureCache[c].baseTexture;e._glTexture=null;d.WebGLRenderer.updateTexture(e)}for(c=0;c<this.batchs.length;c++)this.batchs[c].restoreLostContext(this.gl),this.batchs[c].dirty=!0;d._restoreBatchs(this.gl);this.contextLost=!1};d._batchs=[];d._getBatch=function(c){return 0===d._batchs.length?new d.WebGLBatch(c):d._batchs.pop()};d._returnBatch=function(c){c.clean();d._batchs.push(c)};d._restoreBatchs=function(c){for(var e=0;e<d._batchs.length;e++)d._batchs[e].restoreLostContext(c)};
d.WebGLBatch=function(c){this.gl=c;this.size=0;this.vertexBuffer=c.createBuffer();this.indexBuffer=c.createBuffer();this.uvBuffer=c.createBuffer();this.colorBuffer=c.createBuffer();this.blendMode=d.blendModes.NORMAL;this.dynamicSize=1};d.WebGLBatch.prototype.constructor=d.WebGLBatch;d.WebGLBatch.prototype.clean=function(){this.verticies=[];this.uvs=[];this.indices=[];this.colors=[];this.dynamicSize=1;this.last=this.texture=null;this.size=0;this.tail=this.head=null};d.WebGLBatch.prototype.restoreLostContext=
function(c){this.gl=c;this.vertexBuffer=c.createBuffer();this.indexBuffer=c.createBuffer();this.uvBuffer=c.createBuffer();this.colorBuffer=c.createBuffer()};d.WebGLBatch.prototype.init=function(c){c.batch=this;this.dirty=!0;this.blendMode=c.blendMode;this.texture=c.texture.baseTexture;this.tail=this.head=c;this.size=1;this.growBatch()};d.WebGLBatch.prototype.insertBefore=function(c,e){this.size++;c.batch=this;this.dirty=!0;var f=e.__prev;e.__prev=c;c.__next=e;f?(c.__prev=f,f.__next=c):this.head=c};
d.WebGLBatch.prototype.insertAfter=function(c,e){this.size++;c.batch=this;this.dirty=!0;var f=e.__next;e.__next=c;c.__prev=e;f?(c.__next=f,f.__prev=c):this.tail=c};d.WebGLBatch.prototype.remove=function(c){this.size--;0===this.size?(c.batch=null,c.__prev=null,c.__next=null):(c.__prev?c.__prev.__next=c.__next:(this.head=c.__next,this.head.__prev=null),c.__next?c.__next.__prev=c.__prev:(this.tail=c.__prev,this.tail.__next=null),c.batch=null,c.__next=null,c.__prev=null,this.dirty=!0)};d.WebGLBatch.prototype.split=
function(c){this.dirty=!0;var e=new d.WebGLBatch(this.gl);e.init(c);e.texture=this.texture;e.tail=this.tail;this.tail=c.__prev;this.tail.__next=null;c.__prev=null;for(var f=0;c;)f++,c.batch=e,c=c.__next;e.size=f;this.size-=f;return e};d.WebGLBatch.prototype.merge=function(c){this.dirty=!0;this.tail.__next=c.head;c.head.__prev=this.tail;this.size+=c.size;this.tail=c.tail;for(c=c.head;c;)c.batch=this,c=c.__next};d.WebGLBatch.prototype.growBatch=function(){var c=this.gl;this.dynamicSize=1===this.size?
1:1.5*this.size;this.verticies=new Float32Array(8*this.dynamicSize);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);c.bufferData(c.ARRAY_BUFFER,this.verticies,c.DYNAMIC_DRAW);this.uvs=new Float32Array(8*this.dynamicSize);c.bindBuffer(c.ARRAY_BUFFER,this.uvBuffer);c.bufferData(c.ARRAY_BUFFER,this.uvs,c.DYNAMIC_DRAW);this.dirtyUVS=!0;this.colors=new Float32Array(4*this.dynamicSize);c.bindBuffer(c.ARRAY_BUFFER,this.colorBuffer);c.bufferData(c.ARRAY_BUFFER,this.colors,c.DYNAMIC_DRAW);this.dirtyColors=
!0;this.indices=new Uint16Array(6*this.dynamicSize);for(var e=this.indices.length/6,f=0;f<e;f++){var d=6*f,h=4*f;this.indices[d+0]=h+0;this.indices[d+1]=h+1;this.indices[d+2]=h+2;this.indices[d+3]=h+0;this.indices[d+4]=h+2;this.indices[d+5]=h+3}c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,this.indices,c.STATIC_DRAW)};d.WebGLBatch.prototype.refresh=function(){this.dynamicSize<this.size&&this.growBatch();for(var c=0,e,f=this.head;f;){e=8*c;var d=f.texture,
h=d.frame,l=d.baseTexture.width,d=d.baseTexture.height;this.uvs[e+0]=h.x/l;this.uvs[e+1]=h.y/d;this.uvs[e+2]=(h.x+h.width)/l;this.uvs[e+3]=h.y/d;this.uvs[e+4]=(h.x+h.width)/l;this.uvs[e+5]=(h.y+h.height)/d;this.uvs[e+6]=h.x/l;this.uvs[e+7]=(h.y+h.height)/d;f.updateFrame=!1;e=4*c;this.colors[e]=this.colors[e+1]=this.colors[e+2]=this.colors[e+3]=f.worldAlpha;f=f.__next;c++}this.dirtyColors=this.dirtyUVS=!0};d.WebGLBatch.prototype.update=function(){for(var c,e,f,k,h,l,m,n,s,q,p,y=0,t=this.head,v=this.verticies,
z=this.uvs,x=this.colors;t;){if(t.vcount===d.visibleCount){e=t.texture.frame.width;f=t.texture.frame.height;k=t.anchor.x;h=t.anchor.y;l=e*(1-k);e*=-k;k=f*(1-h);h=f*-h;f=8*y;c=t.worldTransform;m=c[0];n=c[3];s=c[1];q=c[4];p=c[2];c=c[5];v[f+0]=m*e+s*h+p;v[f+1]=q*h+n*e+c;v[f+2]=m*l+s*h+p;v[f+3]=q*h+n*l+c;v[f+4]=m*l+s*k+p;v[f+5]=q*k+n*l+c;v[f+6]=m*e+s*k+p;v[f+7]=q*k+n*e+c;if(t.updateFrame||t.texture.updateFrame)this.dirtyUVS=!0,k=t.texture,l=k.frame,e=k.baseTexture.width,k=k.baseTexture.height,z[f+0]=
l.x/e,z[f+1]=l.y/k,z[f+2]=(l.x+l.width)/e,z[f+3]=l.y/k,z[f+4]=(l.x+l.width)/e,z[f+5]=(l.y+l.height)/k,z[f+6]=l.x/e,z[f+7]=(l.y+l.height)/k,t.updateFrame=!1;t.cacheAlpha!==t.worldAlpha&&(t.cacheAlpha=t.worldAlpha,l=4*y,x[l]=x[l+1]=x[l+2]=x[l+3]=t.worldAlpha,this.dirtyColors=!0)}else f=8*y,v[f+0]=v[f+1]=v[f+2]=v[f+3]=v[f+4]=v[f+5]=v[f+6]=v[f+7]=0;y++;t=t.__next}};d.WebGLBatch.prototype.render=function(c,e){c=c||0;void 0===e&&(e=this.size);this.dirty&&(this.refresh(),this.dirty=!1);if(0!==this.size){this.update();
var f=this.gl,k=d.defaultShader;f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);f.bufferSubData(f.ARRAY_BUFFER,0,this.verticies);f.vertexAttribPointer(k.aVertexPosition,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);this.dirtyUVS&&(this.dirtyUVS=!1,f.bufferSubData(f.ARRAY_BUFFER,0,this.uvs));f.vertexAttribPointer(k.aTextureCoord,2,f.FLOAT,!1,0,0);f.activeTexture(f.TEXTURE0);f.bindTexture(f.TEXTURE_2D,this.texture._glTexture);f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer);this.dirtyColors&&
(this.dirtyColors=!1,f.bufferSubData(f.ARRAY_BUFFER,0,this.colors));f.vertexAttribPointer(k.colorAttribute,1,f.FLOAT,!1,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f.drawElements(f.TRIANGLES,6*(e-c),f.UNSIGNED_SHORT,12*c)}};d.WebGLRenderGroup=function(c,e){this.gl=c;this.root=null;this.backgroundColor=void 0;this.transparent=void 0===e?!0:e;this.batchs=[];this.toRemove=[];this.filterManager=new d.WebGLFilterManager(this.transparent)};d.WebGLRenderGroup.prototype.constructor=d.WebGLRenderGroup;
d.WebGLRenderGroup.prototype.setRenderable=function(c){this.root&&this.removeDisplayObjectAndChildren(this.root);c.worldVisible=c.visible;this.root=c;this.addDisplayObjectAndChildren(c)};d.WebGLRenderGroup.prototype.render=function(c,e){d.WebGLRenderer.updateTextures();var f=this.gl;f.uniform2f(d.defaultShader.projectionVector,c.x,c.y);this.filterManager.begin(c,e);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);for(var k=0;k<this.batchs.length;k++)f=this.batchs[k],f instanceof d.WebGLBatch?this.batchs[k].render():
this.renderSpecial(f,c)};d.WebGLRenderGroup.prototype.renderSpecific=function(c,e,f){d.WebGLRenderer.updateTextures();this.gl.uniform2f(d.defaultShader.projectionVector,e.x,e.y);this.filterManager.begin(e,f);var k,h,l,m;for(h=c.first;h._iNext&&(!h.renderable||!h.__renderGroup);)h=h._iNext;f=h.batch;if(h instanceof d.Sprite)if(f=h.batch,m=f.head,m===h)k=0;else for(k=1;m.__next!==h;)k++,m=m.__next;else f=h;for(h=c.last;h._iPrev&&(!h.renderable||!h.__renderGroup);)h=h._iNext;if(h instanceof d.Sprite)if(c=
h.batch,m=c.head,m===h)l=0;else for(l=1;m.__next!==h;)l++,m=m.__next;else c=h;if(f===c)f instanceof d.WebGLBatch?f.render(k,l+1):this.renderSpecial(f,e);else{h=this.batchs.indexOf(f);m=this.batchs.indexOf(c);f instanceof d.WebGLBatch?f.render(k):this.renderSpecial(f,e);for(f=h+1;f<m;f++)k=this.batchs[f],k instanceof d.WebGLBatch?this.batchs[f].render():this.renderSpecial(k,e);c instanceof d.WebGLBatch?c.render(0,l+1):this.renderSpecial(c,e)}};d.WebGLRenderGroup.prototype.renderSpecial=function(c,
e){var f=c.vcount===d.visibleCount;c instanceof d.TilingSprite?f&&this.renderTilingSprite(c,e):c instanceof d.Strip?f&&this.renderStrip(c,e):c instanceof d.CustomRenderable?f&&c.renderWebGL(this,e):c instanceof d.Graphics?f&&c.renderable&&d.WebGLGraphics.renderGraphics(c,e):c instanceof d.FilterBlock&&this.handleFilterBlock(c,e)};var L=[],N=0;d.WebGLRenderGroup.prototype.handleFilterBlock=function(c,e){var f=d.gl;if(c.open)c.data instanceof Array?this.filterManager.pushFilter(c):(N++,L.push(c),f.enable(f.STENCIL_TEST),
f.colorMask(!1,!1,!1,!1),f.stencilFunc(f.ALWAYS,1,1),f.stencilOp(f.KEEP,f.KEEP,f.INCR),d.WebGLGraphics.renderGraphics(c.data,e),f.colorMask(!0,!0,!0,!0),f.stencilFunc(f.NOTEQUAL,0,L.length),f.stencilOp(f.KEEP,f.KEEP,f.KEEP));else if(c.data instanceof Array)this.filterManager.popFilter();else{var k=L.pop(c);k&&(f.colorMask(!1,!1,!1,!1),f.stencilFunc(f.ALWAYS,1,1),f.stencilOp(f.KEEP,f.KEEP,f.DECR),d.WebGLGraphics.renderGraphics(k.data,e),f.colorMask(!0,!0,!0,!0),f.stencilFunc(f.NOTEQUAL,0,L.length),
f.stencilOp(f.KEEP,f.KEEP,f.KEEP));f.disable(f.STENCIL_TEST)}};d.WebGLRenderGroup.prototype.updateTexture=function(c){this.removeObject(c);for(var e=c.first;e!==this.root&&(e=e._iPrev,!e.renderable||!e.__renderGroup););for(var f=c.last;f._iNext&&(f=f._iNext,!f.renderable||!f.__renderGroup););this.insertObject(c,e,f)};d.WebGLRenderGroup.prototype.addFilterBlocks=function(c,e){c.__renderGroup=this;e.__renderGroup=this;for(var f=c;f!==this.root.first&&(f=f._iPrev,!f.renderable||!f.__renderGroup););this.insertAfter(c,
f);for(f=e;f!==this.root.first&&(f=f._iPrev,!f.renderable||!f.__renderGroup););this.insertAfter(e,f)};d.WebGLRenderGroup.prototype.removeFilterBlocks=function(c,e){this.removeObject(c);this.removeObject(e)};d.WebGLRenderGroup.prototype.addDisplayObjectAndChildren=function(c){c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c);for(var e=c.first;e!==this.root.first&&(e=e._iPrev,!e.renderable||!e.__renderGroup););for(var f=c.last;f._iNext&&(f=f._iNext,!f.renderable||!f.__renderGroup););
var d=c.first;c=c.last._iNext;do d.__renderGroup=this,d.renderable&&(this.insertObject(d,e,f),e=d),d=d._iNext;while(d!==c)};d.WebGLRenderGroup.prototype.removeDisplayObjectAndChildren=function(c){if(c.__renderGroup===this){do c.__renderGroup=null,c.renderable&&this.removeObject(c),c=c._iNext;while(c)}};d.WebGLRenderGroup.prototype.insertObject=function(c,e,f){var k;if(c instanceof d.Sprite){if(e instanceof d.Sprite){if((k=e.batch)&&k.texture===c.texture.baseTexture&&k.blendMode===c.blendMode){k.insertAfter(c,
e);return}}else k=e;if(f&&f instanceof d.Sprite&&(e=f.batch)){if(e.texture===c.texture.baseTexture&&e.blendMode===c.blendMode){e.insertBefore(c,f);return}if(e===k){e=k.split(f);f=d.WebGLRenderer.getBatch();k=this.batchs.indexOf(k);f.init(c);this.batchs.splice(k+1,0,f,e);return}}f=d.WebGLRenderer.getBatch();f.init(c);k?(k=this.batchs.indexOf(k),this.batchs.splice(k+1,0,f)):this.batchs.push(f)}else c instanceof d.TilingSprite?this.initTilingSprite(c):c instanceof d.Strip&&this.initStrip(c),this.insertAfter(c,
e)};d.WebGLRenderGroup.prototype.insertAfter=function(c,e){var f;if(e instanceof d.Sprite)if(f=e.batch)if(f.tail===e)f=this.batchs.indexOf(f),this.batchs.splice(f+1,0,c);else{var k=f.split(e.__next);f=this.batchs.indexOf(f);this.batchs.splice(f+1,0,c,k)}else this.batchs.push(c);else f=this.batchs.indexOf(e),this.batchs.splice(f+1,0,c)};d.WebGLRenderGroup.prototype.removeObject=function(c){var e;if(c instanceof d.Sprite){var f=c.batch;if(!f)return;f.remove(c);0===f.size&&(e=f)}else e=c;e&&(c=this.batchs.indexOf(e),
-1!==c&&(0!==c&&c!==this.batchs.length-1&&this.batchs[c-1]instanceof d.WebGLBatch&&this.batchs[c+1]instanceof d.WebGLBatch&&this.batchs[c-1].texture===this.batchs[c+1].texture&&this.batchs[c-1].blendMode===this.batchs[c+1].blendMode?(this.batchs[c-1].merge(this.batchs[c+1]),e instanceof d.WebGLBatch&&d.WebGLRenderer.returnBatch(e),d.WebGLRenderer.returnBatch(this.batchs[c+1]),this.batchs.splice(c,2)):(this.batchs.splice(c,1),e instanceof d.WebGLBatch&&d.WebGLRenderer.returnBatch(e))))};d.WebGLRenderGroup.prototype.initTilingSprite=
function(c){var e=this.gl;c.verticies=new Float32Array([0,0,c.width,0,c.width,c.height,0,c.height]);c.uvs=new Float32Array([0,0,1,0,1,1,0,1]);c.colors=new Float32Array([1,1,1,1]);c.indices=new Uint16Array([0,1,3,2]);c._vertexBuffer=e.createBuffer();c._indexBuffer=e.createBuffer();c._uvBuffer=e.createBuffer();c._colorBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c._vertexBuffer);e.bufferData(e.ARRAY_BUFFER,c.verticies,e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,c._uvBuffer);e.bufferData(e.ARRAY_BUFFER,
c.uvs,e.DYNAMIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,c._colorBuffer);e.bufferData(e.ARRAY_BUFFER,c.colors,e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c._indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,c.indices,e.STATIC_DRAW);c.texture.baseTexture._glTexture&&(e.bindTexture(e.TEXTURE_2D,c.texture.baseTexture._glTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT));c.texture.baseTexture._powerOf2=!0};d.WebGLRenderGroup.prototype.renderStrip=
function(c,e){var f=this.gl;d.activateStripShader();var k=d.stripShader,h=d.mat3.clone(c.worldTransform);d.mat3.transpose(h);f.uniformMatrix3fv(k.translationMatrix,!1,h);f.uniform2f(k.projectionVector,e.x,e.y);f.uniform2f(k.offsetVector,-d.offset.x,-d.offset.y);f.uniform1f(k.alpha,c.worldAlpha);c.dirty?(c.dirty=!1,f.bindBuffer(f.ARRAY_BUFFER,c._vertexBuffer),f.bufferData(f.ARRAY_BUFFER,c.verticies,f.STATIC_DRAW),f.vertexAttribPointer(k.aVertexPosition,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,
c._uvBuffer),f.bufferData(f.ARRAY_BUFFER,c.uvs,f.STATIC_DRAW),f.vertexAttribPointer(k.aTextureCoord,2,f.FLOAT,!1,0,0),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,c.texture.baseTexture._glTexture),f.bindBuffer(f.ARRAY_BUFFER,c._colorBuffer),f.bufferData(f.ARRAY_BUFFER,c.colors,f.STATIC_DRAW),f.vertexAttribPointer(k.colorAttribute,1,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c._indexBuffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,c.indices,f.STATIC_DRAW)):(f.bindBuffer(f.ARRAY_BUFFER,
c._vertexBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,c.verticies),f.vertexAttribPointer(k.aVertexPosition,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,c._uvBuffer),f.vertexAttribPointer(k.aTextureCoord,2,f.FLOAT,!1,0,0),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,c.texture.baseTexture._glTexture),f.bindBuffer(f.ARRAY_BUFFER,c._colorBuffer),f.vertexAttribPointer(k.colorAttribute,1,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c._indexBuffer));f.drawElements(f.TRIANGLE_STRIP,c.indices.length,
f.UNSIGNED_SHORT,0);d.deactivateStripShader()};d.WebGLRenderGroup.prototype.renderTilingSprite=function(c,e){var f=this.gl,d=c.tilePosition,h=c.tileScale,l=d.x/c.texture.baseTexture.width,d=d.y/c.texture.baseTexture.height,m=c.width/c.texture.baseTexture.width/h.x,h=c.height/c.texture.baseTexture.height/h.y;c.uvs[0]=0-l;c.uvs[1]=0-d;c.uvs[2]=1*m-l;c.uvs[3]=0-d;c.uvs[4]=1*m-l;c.uvs[5]=1*h-d;c.uvs[6]=0-l;c.uvs[7]=1*h-d;f.bindBuffer(f.ARRAY_BUFFER,c._uvBuffer);f.bufferSubData(f.ARRAY_BUFFER,0,c.uvs);
this.renderStrip(c,e)};d.WebGLRenderGroup.prototype.initStrip=function(c){var e=this.gl;c._vertexBuffer=e.createBuffer();c._indexBuffer=e.createBuffer();c._uvBuffer=e.createBuffer();c._colorBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c._vertexBuffer);e.bufferData(e.ARRAY_BUFFER,c.verticies,e.DYNAMIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,c._uvBuffer);e.bufferData(e.ARRAY_BUFFER,c.uvs,e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,c._colorBuffer);e.bufferData(e.ARRAY_BUFFER,c.colors,e.STATIC_DRAW);
e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c._indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,c.indices,e.STATIC_DRAW)};d.WebGLFilterManager=function(c){this.transparent=c;this.filterStack=[];this.texturePool=[];this.offsetY=this.offsetX=0;this.initShaderBuffers()};d.WebGLFilterManager.prototype.begin=function(c,e){this.width=2*c.x;this.height=2*-c.y;this.buffer=e};d.WebGLFilterManager.prototype.pushFilter=function(c){var e=d.gl;this.filterStack.push(c);var f=c.filterPasses[0];this.offsetX+=c.target.filterArea.x;
this.offsetY+=c.target.filterArea.y;var k=this.texturePool.pop();k?k.resize(this.width,this.height):k=new d.FilterTexture(this.width,this.height);e.bindTexture(e.TEXTURE_2D,k.texture);this.getBounds(c.target);var h=c.target.filterArea,f=f.padding;h.x-=f;h.y-=f;h.width+=2*f;h.height+=2*f;0>h.x&&(h.x=0);h.width>this.width&&(h.width=this.width);0>h.y&&(h.y=0);h.height>this.height&&(h.height=this.height);e.bindFramebuffer(e.FRAMEBUFFER,k.frameBuffer);e.viewport(0,0,h.width,h.height);d.projection.x=h.width/
2;d.projection.y=-h.height/2;d.offset.x=-h.x;d.offset.y=-h.y;e.uniform2f(d.defaultShader.projectionVector,h.width/2,-h.height/2);e.uniform2f(d.defaultShader.offsetVector,-h.x,-h.y);e.colorMask(!0,!0,!0,!0);e.clearColor(0,0,0,0);e.clear(e.COLOR_BUFFER_BIT);c._glFilterTexture=k};d.WebGLFilterManager.prototype.popFilter=function(){var c=d.gl,e=this.filterStack.pop(),f=e.target.filterArea,k=e._glFilterTexture;if(1<e.filterPasses.length){c.viewport(0,0,f.width,f.height);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);
this.vertexArray[0]=0;this.vertexArray[1]=f.height;this.vertexArray[2]=f.width;this.vertexArray[3]=f.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=f.width;this.vertexArray[7]=0;c.bufferSubData(c.ARRAY_BUFFER,0,this.vertexArray);c.bindBuffer(c.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=f.width/this.width;this.uvArray[5]=f.height/this.height;this.uvArray[6]=f.width/this.width;this.uvArray[7]=f.height/this.height;c.bufferSubData(c.ARRAY_BUFFER,0,this.uvArray);var h=this.texturePool.pop();
h||(h=new d.FilterTexture(this.width,this.height));c.bindFramebuffer(c.FRAMEBUFFER,h.frameBuffer);c.clear(c.COLOR_BUFFER_BIT);c.disable(c.BLEND);for(var l=0;l<e.filterPasses.length-1;l++){var m=e.filterPasses[l];c.bindFramebuffer(c.FRAMEBUFFER,h.frameBuffer);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,k.texture);this.applyFilterPass(m,f,f.width,f.height);m=k;k=h;h=m}c.enable(c.BLEND);this.texturePool.push(h)}h=e.filterPasses[e.filterPasses.length-1];this.offsetX-=f.x;this.offsetY-=f.y;
var l=this.width,m=this.height,n=0,s=0,p=this.buffer;0===this.filterStack.length?c.colorMask(!0,!0,!0,this.transparent):(p=this.filterStack[this.filterStack.length-1],f=p.target.filterArea,l=f.width,m=f.height,n=f.x,s=f.y,p=p._glFilterTexture.frameBuffer);d.projection.x=l/2;d.projection.y=-m/2;d.offset.x=n;d.offset.y=s;var f=e.target.filterArea,u=f.x-n,y=f.y-s;c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=u;this.vertexArray[1]=y+f.height;this.vertexArray[2]=u+f.width;this.vertexArray[3]=
y+f.height;this.vertexArray[4]=u;this.vertexArray[5]=y;this.vertexArray[6]=u+f.width;this.vertexArray[7]=y;c.bufferSubData(c.ARRAY_BUFFER,0,this.vertexArray);c.bindBuffer(c.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=f.width/this.width;this.uvArray[5]=f.height/this.height;this.uvArray[6]=f.width/this.width;this.uvArray[7]=f.height/this.height;c.bufferSubData(c.ARRAY_BUFFER,0,this.uvArray);c.viewport(0,0,l,m);c.bindFramebuffer(c.FRAMEBUFFER,p);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,
k.texture);this.applyFilterPass(h,f,l,m);c.useProgram(d.defaultShader.program);c.uniform2f(d.defaultShader.projectionVector,l/2,-m/2);c.uniform2f(d.defaultShader.offsetVector,-n,-s);this.texturePool.push(k);e._glFilterTexture=null};d.WebGLFilterManager.prototype.applyFilterPass=function(c,e,f,k){e=d.gl;var h=c.shader;h||(h=new d.PixiShader,h.fragmentSrc=c.fragmentSrc,h.uniforms=c.uniforms,h.init(),c.shader=h);e.useProgram(h.program);e.uniform2f(h.projectionVector,f/2,-k/2);e.uniform2f(h.offsetVector,
0,0);c.uniforms.dimensions&&(c.uniforms.dimensions.value[0]=this.width,c.uniforms.dimensions.value[1]=this.height,c.uniforms.dimensions.value[2]=this.vertexArray[0],c.uniforms.dimensions.value[3]=this.vertexArray[5]);h.syncUniforms();e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.vertexAttribPointer(h.aVertexPosition,2,e.FLOAT,!1,0,0);e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer);e.vertexAttribPointer(h.aTextureCoord,2,e.FLOAT,!1,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);e.drawElements(e.TRIANGLES,
6,e.UNSIGNED_SHORT,0)};d.WebGLFilterManager.prototype.initShaderBuffers=function(){var c=d.gl;this.vertexBuffer=c.createBuffer();this.uvBuffer=c.createBuffer();this.indexBuffer=c.createBuffer();this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);c.bufferData(c.ARRAY_BUFFER,this.vertexArray,c.STATIC_DRAW);this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]);c.bindBuffer(c.ARRAY_BUFFER,this.uvBuffer);c.bufferData(c.ARRAY_BUFFER,this.uvArray,c.STATIC_DRAW);
c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),c.STATIC_DRAW)};d.WebGLFilterManager.prototype.getBounds=function(c){var e,f,k,h,l,m,n,s,p,u,y,t,v,z,x,D,A=c.first,w=c.last._iNext,B=-Infinity,E=-Infinity,F=Infinity,C=Infinity;do A.visible&&(A instanceof d.Sprite?(f=A.texture.frame.width,k=A.texture.frame.height,h=A.anchor.x,l=A.anchor.y,m=f*(1-h),f*=-h,h=k*(1-l),k*=-l,l=!0):A instanceof d.Graphics&&(A.updateFilterBounds(),k=A.bounds,
m=k.x,f=k.x+k.width,h=k.y,k=k.y+k.height,l=!0)),l&&(e=A.worldTransform,n=e[0],l=e[3],s=e[1],p=e[4],u=e[2],y=e[5],e=n*f+s*k+u,z=p*k+l*f+y,t=n*m+s*k+u,x=p*k+l*m+y,v=n*m+s*h+u,D=p*h+l*m+y,n=n*f+s*h+u,l=p*h+l*f+y,F=e<F?e:F,F=t<F?t:F,F=v<F?v:F,F=n<F?n:F,C=z<C?z:C,C=x<C?x:C,C=D<C?D:C,C=l<C?l:C,B=e>B?e:B,B=t>B?t:B,B=v>B?v:B,B=n>B?n:B,E=z>E?z:E,E=x>E?x:E,E=D>E?D:E,E=l>E?l:E),l=!1,A=A._iNext;while(A!==w);c.filterArea.x=F;c.filterArea.y=C;c.filterArea.width=B-F;c.filterArea.height=E-C};d.FilterTexture=function(c,
e){var f=d.gl;this.frameBuffer=f.createFramebuffer();this.texture=f.createTexture();f.bindTexture(f.TEXTURE_2D,this.texture);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.bindFramebuffer(f.FRAMEBUFFER,this.framebuffer);f.bindFramebuffer(f.FRAMEBUFFER,this.frameBuffer);f.framebufferTexture2D(f.FRAMEBUFFER,
f.COLOR_ATTACHMENT0,f.TEXTURE_2D,this.texture,0);this.resize(c,e)};d.FilterTexture.prototype.resize=function(c,e){if(this.width!==c||this.height!==e){this.width=c;this.height=e;var f=d.gl;f.bindTexture(f.TEXTURE_2D,this.texture);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,c,e,0,f.RGBA,f.UNSIGNED_BYTE,null)}};d.CanvasRenderer=function(c,e,f,d){this.transparent=d;this.width=c||800;this.height=e||600;this.view=f||document.createElement("canvas");this.context=this.view.getContext("2d");this.smoothProperty=null;
"imageSmoothingEnabled"in this.context?this.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.smoothProperty="oImageSmoothingEnabled");this.scaleMode=null;this.refresh=!0;this.view.width=this.width;this.view.height=this.height;this.count=0};d.CanvasRenderer.prototype.constructor=d.CanvasRenderer;
d.CanvasRenderer.prototype.render=function(c){d.texturesToUpdate=[];d.texturesToDestroy=[];d.visibleCount++;c.updateTransform();this.view.style.backgroundColor===c.backgroundColorString||this.transparent||(this.view.style.backgroundColor=c.backgroundColorString);this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height);this.renderDisplayObject(c);c.interactive&&!c._interactiveEventsAdded&&(c._interactiveEventsAdded=!0,c.interactionManager.setTarget(this));0<d.Texture.frameUpdates.length&&
(d.Texture.frameUpdates=[])};d.CanvasRenderer.prototype.resize=function(c,e){this.width=c;this.height=e;this.view.width=c;this.view.height=e};d.CanvasRenderer.prototype.renderDisplayObject=function(c){var e,f=this.context;f.globalCompositeOperation="source-over";var k=c.last._iNext;c=c.first;do if(e=c.worldTransform,c.visible){if(c.renderable)if(c instanceof d.Sprite){var h=c.texture.frame;h&&(h.width&&h.height&&c.texture.baseTexture.source)&&(f.globalAlpha=c.worldAlpha,f.setTransform(e[0],e[3],e[1],
e[4],e[2],e[5]),this.smoothProperty&&this.scaleMode!==c.texture.baseTexture.scaleMode&&(this.scaleMode=c.texture.baseTexture.scaleMode,f[this.smoothProperty]=this.scaleMode===d.BaseTexture.SCALE_MODE.LINEAR),f.drawImage(c.texture.baseTexture.source,h.x,h.y,h.width,h.height,c.anchor.x*-h.width,c.anchor.y*-h.height,h.width,h.height))}else if(c instanceof d.Strip)f.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),this.renderStrip(c);else if(c instanceof d.TilingSprite)f.setTransform(e[0],e[3],e[1],e[4],e[2],
e[5]),this.renderTilingSprite(c);else if(c instanceof d.CustomRenderable)f.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),c.renderCanvas(this);else if(c instanceof d.Graphics)f.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),d.CanvasGraphics.renderGraphics(c,f);else if(c instanceof d.FilterBlock&&c.data instanceof d.Graphics)if(e=c.data,c.open){f.save();var h=e.alpha,l=e.worldTransform;f.setTransform(l[0],l[3],l[1],l[4],l[2],l[5]);e.worldAlpha=0.5;f.worldAlpha=0;d.CanvasGraphics.renderGraphicsMask(e,f);
f.clip();e.worldAlpha=h}else f.restore();c=c._iNext}else c=c.last._iNext;while(c!==k)};d.CanvasRenderer.prototype.renderStripFlat=function(c){var e=this.context;c=c.verticies;var f=c.length/2;this.count++;e.beginPath();for(var d=1;d<f-2;d++){var h=2*d,l=c[h+2],m=c[h+4],n=c[h+3],s=c[h+5];e.moveTo(c[h],c[h+1]);e.lineTo(l,n);e.lineTo(m,s)}e.fillStyle="#FF0000";e.fill();e.closePath()};d.CanvasRenderer.prototype.renderTilingSprite=function(c){var e=this.context;e.globalAlpha=c.worldAlpha;c.__tilePattern||
(c.__tilePattern=e.createPattern(c.texture.baseTexture.source,"repeat"));e.beginPath();var f=c.tilePosition,d=c.tileScale;e.scale(d.x,d.y);e.translate(f.x,f.y);e.fillStyle=c.__tilePattern;e.fillRect(-f.x,-f.y,c.width/d.x,c.height/d.y);e.scale(1/d.x,1/d.y);e.translate(-f.x,-f.y);e.closePath()};d.CanvasRenderer.prototype.renderStrip=function(c){var e=this.context,f=c.verticies,d=c.uvs,h=f.length/2;this.count++;for(var l=1;l<h-2;l++){var m=2*l,n=f[m],s=f[m+2],p=f[m+4],u=f[m+1],y=f[m+3],t=f[m+5],v=d[m]*
c.texture.width,z=d[m+2]*c.texture.width,x=d[m+4]*c.texture.width,D=d[m+1]*c.texture.height,A=d[m+3]*c.texture.height,m=d[m+5]*c.texture.height;e.save();e.beginPath();e.moveTo(n,u);e.lineTo(s,y);e.lineTo(p,t);e.closePath();e.clip();var w=v*A+D*x+z*m-A*x-D*z-v*m;e.transform((n*A+D*p+s*m-A*p-D*s-n*m)/w,(u*A+D*t+y*m-A*t-D*y-u*m)/w,(v*s+n*x+z*p-s*x-n*z-v*p)/w,(v*y+u*x+z*t-y*x-u*z-v*t)/w,(v*A*p+D*s*x+n*z*m-n*A*x-D*z*p-v*s*m)/w,(v*A*t+D*y*x+u*z*m-u*A*x-D*z*t-v*y*m)/w);e.drawImage(c.texture.baseTexture.source,
0,0);e.restore()}};d.CanvasGraphics=function(){};d.CanvasGraphics.renderGraphics=function(c,e){for(var f=c.worldAlpha,k=0;k<c.graphicsData.length;k++){var h=c.graphicsData[k],l=h.points;e.strokeStyle="#"+("00000"+(h.lineColor|0).toString(16)).substr(-6);e.lineWidth=h.lineWidth;if(h.type===d.Graphics.POLY){e.beginPath();e.moveTo(l[0],l[1]);for(var m=1;m<l.length/2;m++)e.lineTo(l[2*m],l[2*m+1]);l[0]===l[l.length-2]&&l[1]===l[l.length-1]&&e.closePath();h.fill&&(e.globalAlpha=h.fillAlpha*f,e.fillStyle=
"#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),e.fill());h.lineWidth&&(e.globalAlpha=h.lineAlpha*f,e.stroke())}else if(h.type===d.Graphics.RECT){if(h.fillColor||0===h.fillColor)e.globalAlpha=h.fillAlpha*f,e.fillStyle="#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),e.fillRect(l[0],l[1],l[2],l[3]);h.lineWidth&&(e.globalAlpha=h.lineAlpha*f,e.strokeRect(l[0],l[1],l[2],l[3]))}else if(h.type===d.Graphics.CIRC)e.beginPath(),e.arc(l[0],l[1],l[2],0,2*Math.PI),e.closePath(),h.fill&&(e.globalAlpha=
h.fillAlpha*f,e.fillStyle="#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),e.fill()),h.lineWidth&&(e.globalAlpha=h.lineAlpha*f,e.stroke());else if(h.type===d.Graphics.ELIP){var n=h.points,p=2*n[2],m=2*n[3],l=n[0]-p/2,n=n[1]-m/2;e.beginPath();var q=0.5522848*(p/2),u=0.5522848*(m/2),y=l+p,t=n+m,p=l+p/2,m=n+m/2;e.moveTo(l,m);e.bezierCurveTo(l,m-u,p-q,n,p,n);e.bezierCurveTo(p+q,n,y,m-u,y,m);e.bezierCurveTo(y,m+u,p+q,t,p,t);e.bezierCurveTo(p-q,t,l,m+u,l,m);e.closePath();h.fill&&(e.globalAlpha=h.fillAlpha*
f,e.fillStyle="#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),e.fill());h.lineWidth&&(e.globalAlpha=h.lineAlpha*f,e.stroke())}}};d.CanvasGraphics.renderGraphicsMask=function(c,e){var f=c.graphicsData.length;if(0!==f)for(1<f&&window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"),f=0;1>f;f++){var k=c.graphicsData[f],h=k.points;if(k.type===d.Graphics.POLY){e.beginPath();e.moveTo(h[0],h[1]);for(k=1;k<h.length/2;k++)e.lineTo(h[2*k],h[2*k+
1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&e.closePath()}else if(k.type===d.Graphics.RECT)e.beginPath(),e.rect(h[0],h[1],h[2],h[3]),e.closePath();else if(k.type===d.Graphics.CIRC)e.beginPath(),e.arc(h[0],h[1],h[2],0,2*Math.PI),e.closePath();else if(k.type===d.Graphics.ELIP){var l=k.points,m=2*l[2],k=2*l[3],h=l[0]-m/2,l=l[1]-k/2;e.beginPath();var n=0.5522848*(m/2),p=0.5522848*(k/2),q=h+m,u=l+k,m=h+m/2,k=l+k/2;e.moveTo(h,k);e.bezierCurveTo(h,k-p,m-n,l,m,l);e.bezierCurveTo(m+n,l,q,k-p,q,k);e.bezierCurveTo(q,
k+p,m+n,u,m,u);e.bezierCurveTo(m-n,u,h,k+p,h,k);e.closePath()}}};d.Graphics=function(){d.DisplayObjectContainer.call(this);this.renderable=!0;this.fillAlpha=1;this.lineWidth=0;this.lineColor="black";this.graphicsData=[];this.currentPath={points:[]}};d.Graphics.prototype=Object.create(d.DisplayObjectContainer.prototype);d.Graphics.prototype.constructor=d.Graphics;d.Graphics.prototype.lineStyle=function(c,e,f){this.currentPath.points.length||this.graphicsData.pop();this.lineWidth=c||0;this.lineColor=
e||0;this.lineAlpha=3>arguments.length?1:f;this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:d.Graphics.POLY};this.graphicsData.push(this.currentPath)};d.Graphics.prototype.moveTo=function(c,e){this.currentPath.points.length||this.graphicsData.pop();this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,
fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:d.Graphics.POLY};this.currentPath.points.push(c,e);this.graphicsData.push(this.currentPath)};d.Graphics.prototype.lineTo=function(c,e){this.currentPath.points.push(c,e);this.dirty=!0};d.Graphics.prototype.beginFill=function(c,e){this.filling=!0;this.fillColor=c||0;this.fillAlpha=2>arguments.length?1:e};d.Graphics.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1};d.Graphics.prototype.drawRect=function(c,e,f,
k){this.currentPath.points.length||this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[c,e,f,k],type:d.Graphics.RECT};this.graphicsData.push(this.currentPath);this.dirty=!0};d.Graphics.prototype.drawCircle=function(c,e,f){this.currentPath.points.length||this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,
fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[c,e,f,f],type:d.Graphics.CIRC};this.graphicsData.push(this.currentPath);this.dirty=!0};d.Graphics.prototype.drawEllipse=function(c,e,f,k){this.currentPath.points.length||this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[c,e,f,k],type:d.Graphics.ELIP};this.graphicsData.push(this.currentPath);
this.dirty=!0};d.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=!1;this.clearDirty=this.dirty=!0;this.graphicsData=[];this.bounds=null};d.Graphics.prototype.updateFilterBounds=function(){if(!this.bounds){for(var c=Infinity,e=-Infinity,f=Infinity,k=-Infinity,h,l,m,n=0;n<this.graphicsData.length;n++){m=this.graphicsData[n];l=m.type;var p=m.lineWidth;h=m.points;if(l===d.Graphics.RECT){l=h.x-p/2;m=h.y-p/2;var q=h.width+p,p=h.height+p,c=l<c?l:c,e=l+q>e?l+q:e,f=m<f?l:f,k=m+p>k?m+p:k}else if(l===
d.Graphics.CIRC||l===d.Graphics.ELIP)l=h.x,m=h.y,p=h.radius+p/2,c=l-p<c?l-p:c,e=l+p>e?l+p:e,f=m-p<f?m-p:f,k=m+p>k?m+p:k;else for(q=0;q<h.length;q+=2)l=h[q],m=h[q+1],c=l-p<c?l-p:c,e=l+p>e?l+p:e,f=m-p<f?m-p:f,k=m+p>k?m+p:k}this.bounds=new d.Rectangle(c,f,e-c,k-f)}};d.Graphics.POLY=0;d.Graphics.RECT=1;d.Graphics.CIRC=2;d.Graphics.ELIP=3;d.Strip=function(c,e,f){d.DisplayObjectContainer.call(this);this.texture=c;this.blendMode=d.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=
new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(k){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=e;this.height=f;c.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind));
this.renderable=!0};d.Strip.prototype=Object.create(d.DisplayObjectContainer.prototype);d.Strip.prototype.constructor=d.Strip;d.Strip.prototype.setTexture=function(c){this.texture=c;this.width=c.frame.width;this.height=c.frame.height;this.updateFrame=!0};d.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0};d.Rope=function(c,e){d.Strip.call(this,c);this.points=e;try{this.verticies=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),
this.indices=new Uint16Array(2*e.length)}catch(f){this.verticies=Array(4*e.length),this.uvs=Array(4*e.length),this.colors=Array(2*e.length),this.indices=Array(2*e.length)}this.refresh()};d.Rope.prototype=Object.create(d.Strip.prototype);d.Rope.prototype.constructor=d.Rope;d.Rope.prototype.refresh=function(){var c=this.points;if(!(1>c.length)){var e=this.uvs,f=this.indices,d=this.colors;this.count-=0.2;e[0]=0;e[1]=1;e[2]=0;e[3]=1;d[0]=1;d[1]=1;f[0]=0;f[1]=1;for(var c=c.length,h,l,m=1;m<c;m++)h=4*m,
l=m/(c-1),e[h]=l,e[h+1]=0,e[h+2]=l,e[h+3]=1,h=2*m,d[h]=1,d[h+1]=1,h=2*m,f[h]=h,f[h+1]=h+1}};d.Rope.prototype.updateTransform=function(){var c=this.points;if(!(1>c.length)){var e=c[0],f,k=f=0;this.count-=0.2;var h=this.verticies;h[0]=e.x+f;h[1]=e.y+k;h[2]=e.x-f;h[3]=e.y-k;for(var l=c.length,m,n,p,q=1;q<l;q++)m=c[q],n=4*q,f=q<c.length-1?c[q+1]:m,k=-(f.x-e.x),f=f.y-e.y,e=Math.sqrt(f*f+k*k),p=this.texture.height/2,f/=e,k/=e,f*=p,k*=p,h[n]=m.x+f,h[n+1]=m.y+k,h[n+2]=m.x-f,h[n+3]=m.y-k,e=m;d.DisplayObjectContainer.prototype.updateTransform.call(this)}};
d.Rope.prototype.setTexture=function(c){this.texture=c;this.updateFrame=!0};d.TilingSprite=function(c,e,f){d.DisplayObjectContainer.call(this);this.texture=c;this.width=e;this.height=f;this.tileScale=new d.Point(1,1);this.tilePosition=new d.Point(0,0);this.renderable=!0;this.blendMode=d.blendModes.NORMAL};d.TilingSprite.prototype=Object.create(d.DisplayObjectContainer.prototype);d.TilingSprite.prototype.constructor=d.TilingSprite;d.TilingSprite.prototype.setTexture=function(c){this.texture=c;this.updateFrame=
!0};d.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0};var p={BoneData:function(c,e){this.name=c;this.parent=e}};p.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1};p.SlotData=function(c,e){this.name=c;this.boneData=e};p.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null};p.Bone=function(c,e){this.data=c;this.parent=e;this.setToSetupPose()};p.Bone.yDown=!1;p.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,
worldScaleX:1,worldScaleY:1,updateWorldTransform:function(c,e){var f=this.parent;null!=f?(this.worldX=this.x*f.m00+this.y*f.m01+f.worldX,this.worldY=this.x*f.m10+this.y*f.m11+f.worldY,this.worldScaleX=f.worldScaleX*this.scaleX,this.worldScaleY=f.worldScaleY*this.scaleY,this.worldRotation=f.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var d=this.worldRotation*Math.PI/180,f=Math.cos(d),
d=Math.sin(d);this.m00=f*this.worldScaleX;this.m10=d*this.worldScaleX;this.m01=-d*this.worldScaleY;this.m11=f*this.worldScaleY;c&&(this.m00=-this.m00,this.m01=-this.m01);e&&(this.m10=-this.m10,this.m11=-this.m11);p.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var c=this.data;this.x=c.x;this.y=c.y;this.rotation=c.rotation;this.scaleX=c.scaleX;this.scaleY=c.scaleY}};p.Slot=function(c,e,f){this.data=c;this.skeleton=e;this.bone=f;this.setToSetupPose()};p.Slot.prototype=
{r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(c){this.attachment=c;this._attachmentTime=this.skeleton.time},setAttachmentTime:function(c){this._attachmentTime=this.skeleton.time-c},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var c=this.data;this.r=c.r;this.g=c.g;this.b=c.b;this.a=c.a;for(var e=this.skeleton.data.slots,f=0,d=e.length;f<d;f++)if(e[f]==c){this.setAttachment(c.attachmentName?this.skeleton.getAttachmentBySlotIndex(f,
c.attachmentName):null);break}}};p.Skin=function(c){this.name=c;this.attachments={}};p.Skin.prototype={addAttachment:function(c,e,f){this.attachments[c+":"+e]=f},getAttachment:function(c,e){return this.attachments[c+":"+e]},_attachAll:function(c,e){for(var f in e.attachments){var d=f.indexOf(":"),h=parseInt(f.substring(0,d),10),l=f.substring(d+1),d=c.slots[h];d.attachment&&d.attachment.name==l&&(h=this.getAttachment(h,l))&&d.setAttachment(h)}}};p.Animation=function(c,e,f){this.name=c;this.timelines=
e;this.duration=f};p.Animation.prototype={apply:function(c,e,f){f&&this.duration&&(e%=this.duration);f=this.timelines;for(var d=0,h=f.length;d<h;d++)f[d].apply(c,e,1)},mix:function(c,e,f,d){f&&this.duration&&(e%=this.duration);f=this.timelines;for(var h=0,l=f.length;h<l;h++)f[h].apply(c,e,d)}};p.binarySearch=function(c,e,f){var d=0,h=Math.floor(c.length/f)-2;if(!h)return f;for(var l=h>>>1;;){c[(l+1)*f]<=e?d=l+1:h=l;if(d==h)return(d+1)*f;l=d+h>>>1}};p.linearSearch=function(c,e,f){for(var d=0,h=c.length-
f;d<=h;d+=f)if(c[d]>e)return d;return-1};p.Curves=function(c){this.curves=[];this.curves.length=6*(c-1)};p.Curves.prototype={setLinear:function(c){this.curves[6*c]=0},setStepped:function(c){this.curves[6*c]=-1},setCurve:function(c,e,f,d,h){var l=0.1*0.1,m=0.1*l,n=3*0.1,p=3*l,l=6*l,q=6*m,u=2*-e+d,y=2*-f+h;d=3*(e-d)+1;h=3*(f-h)+1;c*=6;var t=this.curves;t[c]=e*n+u*p+d*m;t[c+1]=f*n+y*p+h*m;t[c+2]=u*l+d*q;t[c+3]=y*l+h*q;t[c+4]=d*q;t[c+5]=h*q},getCurvePercent:function(c,e){e=0>e?0:1<e?1:e;var f=6*c,d=this.curves,
h=d[f];if(!h)return e;if(-1==h)return 0;for(var l=d[f+1],m=d[f+2],n=d[f+3],p=d[f+4],q=d[f+5],f=h,d=l,u=8;;){if(f>=e)return h=f-h,l=d-l,l+(d-l)*(e-h)/(f-h);if(!u)break;u--;h+=m;l+=n;m+=p;n+=q;f+=h;d+=l}return d+(1-d)*(e-f)/(1-f)}};p.RotateTimeline=function(c){this.curves=new p.Curves(c);this.frames=[];this.frames.length=2*c};p.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(c,e,f){c*=2;this.frames[c]=e;this.frames[c+1]=f},apply:function(c,
e,f){var d=this.frames;if(!(e<d[0])){c=c.bones[this.boneIndex];if(e>=d[d.length-2])d=c.data.rotation+d[d.length-1]-c.rotation;else{var h=p.binarySearch(d,e,2),l=d[h-1],m=d[h];e=1-(e-m)/(d[h-2]-m);e=this.curves.getCurvePercent(h/2-1,e);for(d=d[h+1]-l;180<d;)d-=360;for(;-180>d;)d+=360;d=c.data.rotation+(l+d*e)-c.rotation}for(;180<d;)d-=360;for(;-180>d;)d+=360;c.rotation+=d*f}}};p.TranslateTimeline=function(c){this.curves=new p.Curves(c);this.frames=[];this.frames.length=3*c};p.TranslateTimeline.prototype=
{boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(c,e,f,d){c*=3;this.frames[c]=e;this.frames[c+1]=f;this.frames[c+2]=d},apply:function(c,e,f){var d=this.frames;if(!(e<d[0]))if(c=c.bones[this.boneIndex],e>=d[d.length-3])c.x+=(c.data.x+d[d.length-2]-c.x)*f,c.y+=(c.data.y+d[d.length-1]-c.y)*f;else{var h=p.binarySearch(d,e,3),l=d[h-2],m=d[h-1],n=d[h];e=1-(e-n)/(d[h+-3]-n);e=this.curves.getCurvePercent(h/3-1,e);c.x+=(c.data.x+l+(d[h+1]-l)*e-c.x)*f;c.y+=(c.data.y+m+(d[h+
2]-m)*e-c.y)*f}}};p.ScaleTimeline=function(c){this.curves=new p.Curves(c);this.frames=[];this.frames.length=3*c};p.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(c,e,d,k){c*=3;this.frames[c]=e;this.frames[c+1]=d;this.frames[c+2]=k},apply:function(c,e,d){var k=this.frames;if(!(e<k[0]))if(c=c.bones[this.boneIndex],e>=k[k.length-3])c.scaleX+=(c.data.scaleX-1+k[k.length-2]-c.scaleX)*d,c.scaleY+=(c.data.scaleY-1+k[k.length-1]-c.scaleY)*d;else{var h=
p.binarySearch(k,e,3),l=k[h-2],m=k[h-1],n=k[h];e=1-(e-n)/(k[h+-3]-n);e=this.curves.getCurvePercent(h/3-1,e);c.scaleX+=(c.data.scaleX-1+l+(k[h+1]-l)*e-c.scaleX)*d;c.scaleY+=(c.data.scaleY-1+m+(k[h+2]-m)*e-c.scaleY)*d}}};p.ColorTimeline=function(c){this.curves=new p.Curves(c);this.frames=[];this.frames.length=5*c};p.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(c,e,d,k){c*=5;this.frames[c]=e;this.frames[c+1]=r;this.frames[c+2]=g;this.frames[c+
3]=b;this.frames[c+4]=a},apply:function(c,e,d){var k=this.frames;if(!(e<k[0]))if(c=c.slots[this.slotIndex],e>=k[k.length-5])d=k.length-1,c.r=k[d-3],c.g=k[d-2],c.b=k[d-1],c.a=k[d];else{var h=p.binarySearch(k,e,5),l=k[h-4],m=k[h-3],n=k[h-2],s=k[h-1],q=k[h];e=1-(e-q)/(k[h-5]-q);e=this.curves.getCurvePercent(h/5-1,e);l+=(k[h+1]-l)*e;m+=(k[h+2]-m)*e;n+=(k[h+3]-n)*e;k=s+(k[h+4]-s)*e;1>d?(c.r+=(l-c.r)*d,c.g+=(m-c.g)*d,c.b+=(n-c.b)*d,c.a+=(k-c.a)*d):(c.r=l,c.g=m,c.b=n,c.a=k)}}};p.AttachmentTimeline=function(c){this.curves=
new p.Curves(c);this.frames=[];this.frames.length=c;this.attachmentNames=[];this.attachmentNames.length=c};p.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(c,e,d){this.frames[c]=e;this.attachmentNames[c]=d},apply:function(c,e,d){d=this.frames;e<d[0]||(e=e>=d[d.length-1]?d.length-1:p.binarySearch(d,e,1)-1,e=this.attachmentNames[e],c.slots[this.slotIndex].setAttachment(e?c.getAttachmentBySlotIndex(this.slotIndex,e):null))}};p.SkeletonData=
function(){this.bones=[];this.slots=[];this.skins=[];this.animations=[]};p.SkeletonData.prototype={defaultSkin:null,findBone:function(c){for(var e=this.bones,d=0,k=e.length;d<k;d++)if(e[d].name==c)return e[d];return null},findBoneIndex:function(c){for(var e=this.bones,d=0,k=e.length;d<k;d++)if(e[d].name==c)return d;return-1},findSlot:function(c){for(var e=this.slots,d=0,k=e.length;d<k;d++)if(e[d].name==c)return slot[d];return null},findSlotIndex:function(c){for(var e=this.slots,d=0,k=e.length;d<k;d++)if(e[d].name==
c)return d;return-1},findSkin:function(c){for(var e=this.skins,d=0,k=e.length;d<k;d++)if(e[d].name==c)return e[d];return null},findAnimation:function(c){for(var e=this.animations,d=0,k=e.length;d<k;d++)if(e[d].name==c)return e[d];return null}};p.Skeleton=function(c){this.data=c;this.bones=[];for(var e=0,d=c.bones.length;e<d;e++){var k=c.bones[e],h=k.parent?this.bones[c.bones.indexOf(k.parent)]:null;this.bones.push(new p.Bone(k,h))}this.slots=[];this.drawOrder=[];e=0;for(d=c.slots.length;e<d;e++)k=
c.slots[e],h=this.bones[c.bones.indexOf(k.boneData)],k=new p.Slot(k,this,h),this.slots.push(k),this.drawOrder.push(k)};p.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var c=this.flipX,e=this.flipY,d=this.bones,k=0,h=d.length;k<h;k++)d[k].updateWorldTransform(c,e)},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var c=this.bones,e=0,d=c.length;e<d;e++)c[e].setToSetupPose()},
setSlotsToSetupPose:function(){for(var c=this.slots,e=0,d=c.length;e<d;e++)c[e].setToSetupPose(e)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(c){for(var e=this.bones,d=0,k=e.length;d<k;d++)if(e[d].data.name==c)return e[d];return null},findBoneIndex:function(c){for(var e=this.bones,d=0,k=e.length;d<k;d++)if(e[d].data.name==c)return d;return-1},findSlot:function(c){for(var e=this.slots,d=0,k=e.length;d<k;d++)if(e[d].data.name==c)return e[d];return null},findSlotIndex:function(c){for(var e=
this.slots,d=0,k=e.length;d<k;d++)if(e[d].data.name==c)return d;return-1},setSkinByName:function(c){var e=this.data.findSkin(c);if(!e)throw"Skin not found: "+c;this.setSkin(e)},setSkin:function(c){this.skin&&c&&c._attachAll(this,this.skin);this.skin=c},getAttachmentBySlotName:function(c,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(c),e)},getAttachmentBySlotIndex:function(c,e){if(this.skin){var d=this.skin.getAttachment(c,e);if(d)return d}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(c,
e):null},setAttachment:function(c,e){for(var d=this.slots,k=0,h=d.size;k<h;k++){var l=d[k];if(l.data.name==c){d=null;if(e&&(d=this.getAttachment(k,e),null==d))throw"Attachment not found: "+e+", for slot: "+c;l.setAttachment(d);return}}throw"Slot not found: "+c;},update:function(c){time+=c}};p.AttachmentType={region:0};p.RegionAttachment=function(){this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};p.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,
rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(c,e,d,k,h){var l=this.uvs;h?(l[2]=c,l[3]=k,l[4]=c,l[5]=e,l[6]=d,l[7]=e,l[0]=d,l[1]=k):(l[0]=c,l[1]=k,l[2]=c,l[3]=e,l[4]=d,l[5]=e,l[6]=d,l[7]=k)},updateOffset:function(){var c=this.width/this.regionOriginalWidth*this.scaleX,d=this.height/this.regionOriginalHeight*this.scaleY,f=-this.width/2*this.scaleX+this.regionOffsetX*c,k=-this.height/2*this.scaleY+this.regionOffsetY*
d,h=f+this.regionWidth*c,c=k+this.regionHeight*d,d=this.rotation*Math.PI/180,l=Math.cos(d),m=Math.sin(d),d=f*l+this.x,f=f*m,n=k*l+this.y,k=k*m,p=h*l+this.x,h=h*m,l=c*l+this.y,c=c*m,m=this.offset;m[0]=d-k;m[1]=n+f;m[2]=d-c;m[3]=l+f;m[4]=p-c;m[5]=l+h;m[6]=p-k;m[7]=n+h},computeVertices:function(c,d,f,k){c+=f.worldX;d+=f.worldY;var h=f.m00,l=f.m01,m=f.m10;f=f.m11;var n=this.offset;k[0]=n[0]*h+n[1]*l+c;k[1]=n[0]*m+n[1]*f+d;k[2]=n[2]*h+n[3]*l+c;k[3]=n[2]*m+n[3]*f+d;k[4]=n[4]*h+n[5]*l+c;k[5]=n[4]*m+n[5]*
f+d;k[6]=n[6]*h+n[7]*l+c;k[7]=n[6]*m+n[7]*f+d}};p.AnimationStateData=function(c){this.skeletonData=c;this.animationToMixTime={}};p.AnimationStateData.prototype={defaultMix:0,setMixByName:function(c,d,f){var k=this.skeletonData.findAnimation(c);if(!k)throw"Animation not found: "+c;c=this.skeletonData.findAnimation(d);if(!c)throw"Animation not found: "+d;this.setMix(k,c,f)},setMix:function(c,d,f){this.animationToMixTime[c.name+":"+d.name]=f},getMix:function(c,d){var f=this.animationToMixTime[c.name+
":"+d.name];return f?f:this.defaultMix}};p.AnimationState=function(c){this.data=c;this.queue=[]};p.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(c){this.currentTime+=c;this.previousTime+=c;this.mixTime+=c;0<this.queue.length&&(c=this.queue[0],this.currentTime>=c.delay&&(this._setAnimation(c.animation,c.loop),this.queue.shift()))},apply:function(c){if(this.current)if(this.previous){this.previous.apply(c,
this.previousTime,this.previousLoop);var d=this.mixTime/this.mixDuration;1<=d&&(d=1,this.previous=null);this.current.mix(c,this.currentTime,this.currentLoop,d)}else this.current.apply(c,this.currentTime,this.currentLoop)},clearAnimation:function(){this.current=this.previous=null;this.queue.length=0},_setAnimation:function(c,d){this.previous=null;c&&this.current&&(this.mixDuration=this.data.getMix(this.current,c),0<this.mixDuration&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,
this.previousLoop=this.currentLoop));this.current=c;this.currentLoop=d;this.currentTime=0},setAnimationByName:function(c,d){var f=this.data.skeletonData.findAnimation(c);if(!f)throw"Animation not found: "+c;this.setAnimation(f,d)},setAnimation:function(c,d){this.queue.length=0;this._setAnimation(c,d)},addAnimationByName:function(c,d,f){var k=this.data.skeletonData.findAnimation(c);if(!k)throw"Animation not found: "+c;this.addAnimation(k,d,f)},addAnimation:function(c,d,f){var k={};k.animation=c;k.loop=
d;if(!f||0>=f)d=this.queue.length?this.queue[this.queue.length-1].animation:this.current,f=null!=d?d.duration-this.data.getMix(d,c)+(f||0):0;k.delay=f;this.queue.push(k)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}};p.SkeletonJson=function(c){this.attachmentLoader=c};p.SkeletonJson.prototype={scale:1,readSkeletonData:function(c){for(var d=new p.SkeletonData,f,k=c.bones,h=0,l=k.length;h<l;h++){var m=k[h];f=null;if(m.parent&&(f=d.findBone(m.parent),!f))throw"Parent bone not found: "+
m.parent;f=new p.BoneData(m.name,f);f.length=(m.length||0)*this.scale;f.x=(m.x||0)*this.scale;f.y=(m.y||0)*this.scale;f.rotation=m.rotation||0;f.scaleX=m.scaleX||1;f.scaleY=m.scaleY||1;d.bones.push(f)}k=c.slots;h=0;for(l=k.length;h<l;h++){m=k[h];f=d.findBone(m.bone);if(!f)throw"Slot bone not found: "+m.bone;f=new p.SlotData(m.name,f);var n=m.color;n&&(f.r=p.SkeletonJson.toColor(n,0),f.g=p.SkeletonJson.toColor(n,1),f.b=p.SkeletonJson.toColor(n,2),f.a=p.SkeletonJson.toColor(n,3));f.attachmentName=m.attachment;
d.slots.push(f)}var h=c.skins,s;for(s in h)if(h.hasOwnProperty(s)){l=h[s];f=new p.Skin(s);for(var q in l)if(l.hasOwnProperty(q)){var k=d.findSlotIndex(q),m=l[q],u;for(u in m)m.hasOwnProperty(u)&&(n=this.readAttachment(f,u,m[u]),null!=n&&f.addAttachment(k,u,n))}d.skins.push(f);"default"==f.name&&(d.defaultSkin=f)}c=c.animations;for(var y in c)c.hasOwnProperty(y)&&this.readAnimation(y,c[y],d);return d},readAttachment:function(c,d,f){d=f.name||d;c=p.AttachmentType[f.type||"region"];if(c==p.AttachmentType.region)return c=
new p.RegionAttachment,c.x=(f.x||0)*this.scale,c.y=(f.y||0)*this.scale,c.scaleX=f.scaleX||1,c.scaleY=f.scaleY||1,c.rotation=f.rotation||0,c.width=(f.width||32)*this.scale,c.height=(f.height||32)*this.scale,c.updateOffset(),c.rendererObject={},c.rendererObject.name=d,c.rendererObject.scale={},c.rendererObject.scale.x=c.scaleX,c.rendererObject.scale.y=c.scaleY,c.rendererObject.rotation=-c.rotation*Math.PI/180,c;throw"Unknown attachment type: "+c;},readAnimation:function(c,d,f){var k=[],h=0,l,m,n,s,
q,u,y,t=d.bones,v;for(v in t)if(t.hasOwnProperty(v)){var z=f.findBoneIndex(v);if(-1==z)throw"Bone not found: "+v;var x=t[v];for(n in x)if(x.hasOwnProperty(n))if(q=x[n],"rotate"==n){m=new p.RotateTimeline(q.length);m.boneIndex=z;u=l=0;for(y=q.length;u<y;u++)s=q[u],m.setFrame(l,s.time,s.angle),p.SkeletonJson.readCurve(m,l,s),l++;k.push(m);h=Math.max(h,m.frames[2*m.getFrameCount()-2])}else if("translate"==n||"scale"==n){var D=1;"scale"==n?m=new p.ScaleTimeline(q.length):(m=new p.TranslateTimeline(q.length),
D=this.scale);m.boneIndex=z;u=l=0;for(y=q.length;u<y;u++)s=q[u],m.setFrame(l,s.time,(s.x||0)*D,(s.y||0)*D),p.SkeletonJson.readCurve(m,l,s),l++;k.push(m);h=Math.max(h,m.frames[3*m.getFrameCount()-3])}else throw"Invalid timeline type for a bone: "+n+" ("+v+")";}d=d.slots;for(var A in d)if(d.hasOwnProperty(A))for(n in t=d[A],v=f.findSlotIndex(A),t)if(t.hasOwnProperty(n))if(q=t[n],"color"==n){m=new p.ColorTimeline(q.length);m.slotIndex=v;u=l=0;for(y=q.length;u<y;u++){s=q[u];var w=s.color,z=p.SkeletonJson.toColor(w,
0),x=p.SkeletonJson.toColor(w,1),D=p.SkeletonJson.toColor(w,2),w=p.SkeletonJson.toColor(w,3);m.setFrame(l,s.time,z,x,D,w);p.SkeletonJson.readCurve(m,l,s);l++}k.push(m);h=Math.max(h,m.frames[5*m.getFrameCount()-5])}else if("attachment"==n){m=new p.AttachmentTimeline(q.length);m.slotIndex=v;u=l=0;for(y=q.length;u<y;u++)s=q[u],m.setFrame(l++,s.time,s.name);k.push(m);h=Math.max(h,m.frames[m.getFrameCount()-1])}else throw"Invalid timeline type for a slot: "+n+" ("+A+")";f.animations.push(new p.Animation(c,
k,h))}};p.SkeletonJson.readCurve=function(c,d,f){(f=f.curve)&&("stepped"==f?c.curves.setStepped(d):f instanceof Array&&c.curves.setCurve(d,f[0],f[1],f[2],f[3]))};p.SkeletonJson.toColor=function(c,d){if(8!=c.length)throw"Color hexidecimal length must be 8, recieved: "+c;return parseInt(c.substring(2*d,2),16)/255};p.Atlas=function(c,d){this.textureLoader=d;this.pages=[];this.regions=[];var f=new p.AtlasReader(c),k=[];k.length=4;for(var h=null;;){var l=f.readLine();if(null==l)break;l=f.trim(l);if(l.length)if(h){var m=
new p.AtlasRegion;m.name=l;m.page=h;m.rotate="true"==f.readValue();f.readTuple(k);var l=parseInt(k[0],10),n=parseInt(k[1],10);f.readTuple(k);var s=parseInt(k[0],10),q=parseInt(k[1],10);m.u=l/h.width;m.v=n/h.height;m.rotate?(m.u2=(l+q)/h.width,m.v2=(n+s)/h.height):(m.u2=(l+s)/h.width,m.v2=(n+q)/h.height);m.x=l;m.y=n;m.width=Math.abs(s);m.height=Math.abs(q);4==f.readTuple(k)&&(m.splits=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10),parseInt(k[3],10)],4==f.readTuple(k)&&(m.pads=[parseInt(k[0],
10),parseInt(k[1],10),parseInt(k[2],10),parseInt(k[3],10)],f.readTuple(k)));m.originalWidth=parseInt(k[0],10);m.originalHeight=parseInt(k[1],10);f.readTuple(k);m.offsetX=parseInt(k[0],10);m.offsetY=parseInt(k[1],10);m.index=parseInt(f.readValue(),10);this.regions.push(m)}else h=new p.AtlasPage,h.name=l,h.format=p.Atlas.Format[f.readValue()],f.readTuple(k),h.minFilter=p.Atlas.TextureFilter[k[0]],h.magFilter=p.Atlas.TextureFilter[k[1]],m=f.readValue(),h.uWrap=p.Atlas.TextureWrap.clampToEdge,h.vWrap=
p.Atlas.TextureWrap.clampToEdge,"x"==m?h.uWrap=p.Atlas.TextureWrap.repeat:"y"==m?h.vWrap=p.Atlas.TextureWrap.repeat:"xy"==m&&(h.uWrap=h.vWrap=p.Atlas.TextureWrap.repeat),d.load(h,l),this.pages.push(h);else h=null}};p.Atlas.prototype={findRegion:function(c){for(var d=this.regions,f=0,k=d.length;f<k;f++)if(d[f].name==c)return d[f];return null},dispose:function(){for(var c=this.pages,d=0,f=c.length;d<f;d++)this.textureLoader.unload(c[d].rendererObject)},updateUVs:function(c){for(var d=this.regions,f=
0,k=d.length;f<k;f++){var h=d[f];h.page==c&&(h.u=h.x/c.width,h.v=h.y/c.height,h.rotate?(h.u2=(h.x+h.height)/c.width,h.v2=(h.y+h.width)/c.height):(h.u2=(h.x+h.width)/c.width,h.v2=(h.y+h.height)/c.height))}}};p.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};p.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};p.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};
p.AtlasPage=function(){};p.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};p.AtlasRegion=function(){};p.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null};p.AtlasReader=function(c){this.lines=c.split(/\r\n|\r|\n/)};p.AtlasReader.prototype={index:0,trim:function(c){return c.replace(/^\s+|\s+$/g,
"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var c=this.readLine(),d=c.indexOf(":");if(-1==d)throw"Invalid line: "+c;return this.trim(c.substring(d+1))},readTuple:function(c){var d=this.readLine(),f=d.indexOf(":");if(-1==f)throw"Invalid line: "+d;for(var k=0,f=f+1;3>k;k++){var h=d.indexOf(",",f);if(-1==h){if(!k)throw"Invalid line: "+d;break}c[k]=this.trim(d.substr(f,h-f));f=h+1}c[k]=this.trim(d.substring(f));return k+1}};p.AtlasAttachmentLoader=
function(c){this.atlas=c};p.AtlasAttachmentLoader.prototype={newAttachment:function(c,d,f){switch(d){case p.AttachmentType.region:c=this.atlas.findRegion(f);if(!c)throw"Region not found in atlas: "+f+" ("+d+")";d=new p.RegionAttachment(f);d.rendererObject=c;d.setUVs(c.u,c.v,c.u2,c.v2,c.rotate);d.regionOffsetX=c.offsetX;d.regionOffsetY=c.offsetY;d.regionWidth=c.width;d.regionHeight=c.height;d.regionOriginalWidth=c.originalWidth;d.regionOriginalHeight=c.originalHeight;return d}throw"Unknown attachment type: "+
d;}};p.Bone.yDown=!0;d.AnimCache={};d.Spine=function(c){d.DisplayObjectContainer.call(this);this.spineData=d.AnimCache[c];if(!this.spineData)throw Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+c);this.skeleton=new p.Skeleton(this.spineData);this.skeleton.updateWorldTransform();this.stateData=new p.AnimationStateData(this.spineData);this.state=new p.AnimationState(this.stateData);this.slotContainers=[];c=0;for(var e=this.skeleton.drawOrder.length;c<e;c++){var f=
this.skeleton.drawOrder[c],k=f.attachment,h=new d.DisplayObjectContainer;this.slotContainers.push(h);this.addChild(h);if(k instanceof p.RegionAttachment){var l=k.rendererObject.name,k=this.createSprite(f,k.rendererObject);f.currentSprite=k;f.currentSpriteName=l;h.addChild(k)}}};d.Spine.prototype=Object.create(d.DisplayObjectContainer.prototype);d.Spine.prototype.constructor=d.Spine;d.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var c=0.001*(Date.now()-this.lastTime);
this.lastTime=Date.now();this.state.update(c);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform();for(var c=this.skeleton.drawOrder,e=0,f=c.length;e<f;e++){var k=c[e],h=k.attachment,l=this.slotContainers[e];if(h instanceof p.RegionAttachment){if(h.rendererObject&&(!k.currentSpriteName||k.currentSpriteName!=h.name)){var m=h.rendererObject.name;void 0!==k.currentSprite&&(k.currentSprite.visible=!1);k.sprites=k.sprites||{};if(void 0!==k.sprites[m])k.sprites[m].visible=!0;else{var n=
this.createSprite(k,h.rendererObject);l.addChild(n)}k.currentSprite=k.sprites[m];k.currentSpriteName=m}l.visible=!0;m=k.bone;l.position.x=m.worldX+h.x*m.m00+h.y*m.m01;l.position.y=m.worldY+h.x*m.m10+h.y*m.m11;l.scale.x=m.worldScaleX;l.scale.y=m.worldScaleY;l.rotation=-(k.bone.worldRotation*Math.PI/180)}else l.visible=!1}d.DisplayObjectContainer.prototype.updateTransform.call(this)};d.Spine.prototype.createSprite=function(c,e){var f=new d.Sprite(d.Texture.fromFrame(d.TextureCache[e.name]?e.name:e.name+
".png"));f.scale=e.scale;f.rotation=e.rotation;f.anchor.x=f.anchor.y=0.5;c.sprites=c.sprites||{};return c.sprites[e.name]=f};d.CustomRenderable=function(){d.DisplayObject.call(this);this.renderable=!0};d.CustomRenderable.prototype=Object.create(d.DisplayObject.prototype);d.CustomRenderable.prototype.constructor=d.CustomRenderable;d.CustomRenderable.prototype.renderCanvas=function(){};d.CustomRenderable.prototype.initWebGL=function(){};d.CustomRenderable.prototype.renderWebGL=function(){};d.BaseTextureCache=
{};d.texturesToUpdate=[];d.texturesToDestroy=[];d.BaseTexture=function(c,e){d.EventTarget.call(this);this.height=this.width=100;this.scaleMode=e||d.BaseTexture.SCALE_MODE.DEFAULT;this.hasLoaded=!1;if(this.source=c){if(this.source instanceof Image||this.source instanceof HTMLImageElement)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,d.texturesToUpdate.push(this);else{var f=this;this.source.onload=function(){f.hasLoaded=!0;f.width=f.source.width;
f.height=f.source.height;d.texturesToUpdate.push(f);f.dispatchEvent({type:"loaded",content:f})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,d.texturesToUpdate.push(this);this.imageUrl=null;this._powerOf2=!1}};d.BaseTexture.prototype.constructor=d.BaseTexture;d.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.imageUrl in d.BaseTextureCache&&delete d.BaseTextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null);this.source=
null;d.texturesToDestroy.push(this)};d.BaseTexture.prototype.updateSourceImage=function(c){this.hasLoaded=!1;this.source.src=null;this.source.src=c};d.BaseTexture.fromImage=function(c,e,f){var k=d.BaseTextureCache[c];k||(k=new Image,e&&(k.crossOrigin=""),k.src=c,k=new d.BaseTexture(k,f),k.imageUrl=c,d.BaseTextureCache[c]=k);return k};d.BaseTexture.SCALE_MODE={DEFAULT:0,LINEAR:0,NEAREST:1};d.TextureCache={};d.FrameCache={};d.Texture=function(c,e){d.EventTarget.call(this);e||(this.noFrame=!0,e=new d.Rectangle(0,
0,1,1));c instanceof d.Texture&&(c=c.baseTexture);this.baseTexture=c;this.frame=e;this.trim=new d.Point;this.scope=this;if(c.hasLoaded)this.noFrame&&(e=new d.Rectangle(0,0,c.width,c.height)),this.setFrame(e);else{var f=this;c.addEventListener("loaded",function(){f.onBaseTextureLoaded()})}};d.Texture.prototype.constructor=d.Texture;d.Texture.prototype.onBaseTextureLoaded=function(){var c=this.baseTexture;c.removeEventListener("loaded",this.onLoaded);this.noFrame&&(this.frame=new d.Rectangle(0,0,c.width,
c.height));this.noFrame=!1;this.width=this.frame.width;this.height=this.frame.height;this.scope.dispatchEvent({type:"update",content:this})};d.Texture.prototype.destroy=function(c){c&&this.baseTexture.destroy()};d.Texture.prototype.setFrame=function(c){this.frame=c;this.width=c.width;this.height=c.height;if(c.x+c.width>this.baseTexture.width||c.y+c.height>this.baseTexture.height)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0;d.Texture.frameUpdates.push(this)};
d.Texture.fromImage=function(c,e,f){var k=d.TextureCache[c];k||(k=new d.Texture(d.BaseTexture.fromImage(c,e,f)),d.TextureCache[c]=k);return k};d.Texture.fromFrame=function(c){var e=d.TextureCache[c];if(!e)throw Error('The frameId "'+c+'" does not exist in the texture cache '+this);return e};d.Texture.fromCanvas=function(c,e){var f=new d.BaseTexture(c,e);return new d.Texture(f)};d.Texture.addTextureToCache=function(c,e){d.TextureCache[e]=c};d.Texture.removeTextureFromCache=function(c){var e=d.TextureCache[c];
d.TextureCache[c]=null;return e};d.Texture.frameUpdates=[];d.Texture.SCALE_MODE=d.BaseTexture.SCALE_MODE;d.RenderTexture=function(c,e){d.EventTarget.call(this);this.width=c||100;this.height=e||100;this.indetityMatrix=d.mat3.create();this.frame=new d.Rectangle(0,0,this.width,this.height);d.gl?this.initWebGL():this.initCanvas()};d.RenderTexture.prototype=Object.create(d.Texture.prototype);d.RenderTexture.prototype.constructor=d.RenderTexture;d.RenderTexture.prototype.initWebGL=function(){var c=d.gl;
this.glFramebuffer=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,this.glFramebuffer);this.glFramebuffer.width=this.width;this.glFramebuffer.height=this.height;this.baseTexture=new d.BaseTexture;this.baseTexture.width=this.width;this.baseTexture.height=this.height;this.baseTexture._glTexture=c.createTexture();c.bindTexture(c.TEXTURE_2D,this.baseTexture._glTexture);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,this.width,this.height,0,c.RGBA,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,
c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);this.baseTexture.isRender=!0;c.bindFramebuffer(c.FRAMEBUFFER,this.glFramebuffer);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this.baseTexture._glTexture,0);this.projection=new d.Point(this.width/2,-this.height/2);this.render=this.renderWebGL};d.RenderTexture.prototype.resize=function(c,
e){this.width=c;this.height=e;if(d.gl){this.projection.x=this.width/2;this.projection.y=-this.height/2;var f=d.gl;f.bindTexture(f.TEXTURE_2D,this.baseTexture._glTexture);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,this.width,this.height,0,f.RGBA,f.UNSIGNED_BYTE,null)}else this.frame.width=this.width,this.frame.height=this.height,this.renderer.resize(this.width,this.height)};d.RenderTexture.prototype.initCanvas=function(){this.renderer=new d.CanvasRenderer(this.width,this.height,null,0);this.baseTexture=new d.BaseTexture(this.renderer.view);
this.frame=new d.Rectangle(0,0,this.width,this.height);this.render=this.renderCanvas};d.RenderTexture.prototype.renderWebGL=function(c,e,f){var k=d.gl;k.colorMask(!0,!0,!0,!0);k.viewport(0,0,this.width,this.height);k.bindFramebuffer(k.FRAMEBUFFER,this.glFramebuffer);f&&(k.clearColor(0,0,0,0),k.clear(k.COLOR_BUFFER_BIT));var h=c.children;f=c.worldTransform;c.worldTransform=d.mat3.create();c.worldTransform[4]=-1;c.worldTransform[5]=-2*this.projection.y;e&&(c.worldTransform[2]=e.x,c.worldTransform[5]-=
e.y);d.visibleCount++;c.vcount=d.visibleCount;e=0;for(var l=h.length;e<l;e++)h[e].updateTransform();(h=c.__renderGroup)?c===h.root?h.render(this.projection,this.glFramebuffer):h.renderSpecific(c,this.projection,this.glFramebuffer):(this.renderGroup||(this.renderGroup=new d.WebGLRenderGroup(k)),this.renderGroup.setRenderable(c),this.renderGroup.render(this.projection,this.glFramebuffer));c.worldTransform=f};d.RenderTexture.prototype.renderCanvas=function(c,e,f){var k=c.children;c.worldTransform=d.mat3.create();
e&&(c.worldTransform[2]=e.x,c.worldTransform[5]=e.y);e=0;for(var h=k.length;e<h;e++)k[e].updateTransform();f&&this.renderer.context.clearRect(0,0,this.width,this.height);this.renderer.renderDisplayObject(c);this.renderer.context.setTransform(1,0,0,1,0,0)};d.AssetLoader=function(c,e){d.EventTarget.call(this);this.assetURLs=c;this.crossorigin=e;this.loadersByType={jpg:d.ImageLoader,jpeg:d.ImageLoader,png:d.ImageLoader,gif:d.ImageLoader,json:d.JsonLoader,atlas:d.AtlasLoader,anim:d.SpineLoader,xml:d.BitmapFontLoader,
fnt:d.BitmapFontLoader}};d.AssetLoader.prototype.constructor=d.AssetLoader;d.AssetLoader.prototype._getDataType=function(c){if("data:"===c.slice(0,5).toLowerCase()){c=c.slice(5);var d=c.indexOf(",");return-1===d?null:(c=c.slice(0,d).split(";")[0])&&"text/plain"!==c.toLowerCase()?c.split("/").pop().toLowerCase():"txt"}return null};d.AssetLoader.prototype.load=function(){function c(){d.onAssetLoaded()}var d=this;this.loadCount=this.assetURLs.length;for(var f=0;f<this.assetURLs.length;f++){var k=this.assetURLs[f],
h=this._getDataType(k);h||(h=k.split("?").shift().split(".").pop().toLowerCase());var l=this.loadersByType[h];if(!l)throw Error(h+" is an unsupported file type");k=new l(k,this.crossorigin);k.addEventListener("loaded",c);k.load()}};d.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--;this.dispatchEvent({type:"onProgress",content:this});if(this.onProgress)this.onProgress();if(!this.loadCount&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete))this.onComplete()};d.JsonLoader=
function(c,e){d.EventTarget.call(this);this.url=c;this.crossorigin=e;this.baseUrl=c.replace(/[^\/]*$/,"");this.loaded=!1};d.JsonLoader.prototype.constructor=d.JsonLoader;d.JsonLoader.prototype.load=function(){this.ajaxRequest=new d.AjaxRequest;var c=this;this.ajaxRequest.onreadystatechange=function(){c.onJSONLoaded()};this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json");this.ajaxRequest.send(null)};d.JsonLoader.prototype.onJSONLoaded=
function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var c=this,e=new d.ImageLoader(this.baseUrl+this.json.meta.image,this.crossorigin),f=this.json.frames;this.texture=e.texture.baseTexture;e.addEventListener("loaded",function(){c.onLoaded()});for(var k in f){var h=f[k].frame;h&&(d.TextureCache[k]=new d.Texture(this.texture,{x:h.x,y:h.y,width:h.w,height:h.h}),
f[k].trimmed&&(d.TextureCache[k].realSize=f[k].spriteSourceSize,d.TextureCache[k].trim.x=0))}e.load()}else this.json.bones&&(e=(new p.SkeletonJson).readSkeletonData(this.json),d.AnimCache[this.url]=e),this.onLoaded();else this.onError()};d.JsonLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};d.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};d.AtlasLoader=function(c,e){d.EventTarget.call(this);this.url=c;
this.baseUrl=c.replace(/[^\/]*$/,"");this.crossorigin=e;this.loaded=!1};d.AtlasLoader.constructor=d.AtlasLoader;d.AtlasLoader.prototype.load=function(){this.ajaxRequest=new d.AjaxRequest;this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this);this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json");this.ajaxRequest.send(null)};d.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===
this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};for(var c=this.ajaxRequest.responseText.split(/\r?\n/),e=-3,f=0,k=null,h=!1,l=0,m=0,n=this.onLoaded.bind(this),l=0;l<c.length;l++)c[l]=c[l].replace(/^\s+|\s+$/g,""),""===c[l]&&(h=l+1),0<c[l].length&&(h===l?(this.atlas.meta.image.push(c[l]),f=this.atlas.meta.image.length-1,this.atlas.frames.push({}),e=-3):0<e&&(1===e%7?(null!=k&&(this.atlas.frames[f][k.name]=k),k={name:c[l],frame:{}}):(m=c[l].split(" "),
3===e%7?(k.frame.x=Number(m[1].replace(",","")),k.frame.y=Number(m[2])):4===e%7?(k.frame.w=Number(m[1].replace(",","")),k.frame.h=Number(m[2])):5===e%7&&(m={x:0,y:0,w:Number(m[1].replace(",","")),h:Number(m[2])},m.w>k.frame.w||m.h>k.frame.h?(k.trimmed=!0,k.realSize=m):k.trimmed=!1))),e++);null!=k&&(this.atlas.frames[f][k.name]=k);if(0<this.atlas.meta.image.length){this.images=[];for(m=0;m<this.atlas.meta.image.length;m++)for(l in c=this.atlas.frames[m],this.images.push(new d.ImageLoader(this.baseUrl+
this.atlas.meta.image[m],this.crossorigin)),c)if(e=c[l].frame)d.TextureCache[l]=new d.Texture(this.images[m].texture.baseTexture,{x:e.x,y:e.y,width:e.w,height:e.h}),c[l].trimmed&&(d.TextureCache[l].realSize=c[l].realSize,d.TextureCache[l].trim.x=0,d.TextureCache[l].trim.y=0);for(m=this.currentImageId=0;m<this.images.length;m++)this.images[m].addEventListener("loaded",n);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()};d.AtlasLoader.prototype.onLoaded=function(){this.images.length-
1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))};d.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};d.SpriteSheetLoader=function(c,e){d.EventTarget.call(this);this.url=c;this.crossorigin=e;this.baseUrl=c.replace(/[^\/]*$/,"");this.texture=null;this.frames={}};d.SpriteSheetLoader.prototype.constructor=d.SpriteSheetLoader;d.SpriteSheetLoader.prototype.load=
function(){var c=this,e=new d.JsonLoader(this.url,this.crossorigin);e.addEventListener("loaded",function(d){c.json=d.content.json;c.onJSONLoaded()});e.load()};d.SpriteSheetLoader.prototype.onJSONLoaded=function(){var c=this,e=new d.ImageLoader(this.baseUrl+this.json.meta.image,this.crossorigin),f=this.json.frames;this.texture=e.texture.baseTexture;e.addEventListener("loaded",function(){c.onLoaded()});for(var k in f){var h=f[k].frame;h&&(d.TextureCache[k]=new d.Texture(this.texture,{x:h.x,y:h.y,width:h.w,
height:h.h}),f[k].trimmed&&(d.TextureCache[k].realSize=f[k].spriteSourceSize,d.TextureCache[k].trim.x=0))}e.load()};d.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};d.ImageLoader=function(c,e){d.EventTarget.call(this);this.texture=d.Texture.fromImage(c,e);this.frames=[]};d.ImageLoader.prototype.constructor=d.ImageLoader;d.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var c=this;this.texture.baseTexture.addEventListener("loaded",
function(){c.onLoaded()})}};d.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};d.ImageLoader.prototype.loadFramedSpriteSheet=function(c,e,f){this.frames=[];for(var k=Math.floor(this.texture.width/c),h=Math.floor(this.texture.height/e),l=0,m=0;m<h;m++)for(var n=0;n<k;n++,l++){var p=new d.Texture(this.texture,{x:n*c,y:m*e,width:c,height:e});this.frames.push(p);f&&(d.TextureCache[f+"-"+l]=p)}if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var q=this;
this.texture.baseTexture.addEventListener("loaded",function(){q.onLoaded()})}};d.BitmapFontLoader=function(c,e){d.EventTarget.call(this);this.url=c;this.crossorigin=e;this.baseUrl=c.replace(/[^\/]*$/,"");this.texture=null};d.BitmapFontLoader.prototype.constructor=d.BitmapFontLoader;d.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new XMLHttpRequest;var c=this;this.ajaxRequest.onreadystatechange=function(){c.onXMLLoaded()};this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&
this.ajaxRequest.overrideMimeType("application/xml");this.ajaxRequest.send(null)};d.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var c=this.baseUrl+this.ajaxRequest.responseXML.getElementsByTagName("page")[0].attributes.getNamedItem("file").nodeValue,c=new d.ImageLoader(c,this.crossorigin);this.texture=c.texture.baseTexture;var e={},f=this.ajaxRequest.responseXML.getElementsByTagName("info")[0],
k=this.ajaxRequest.responseXML.getElementsByTagName("common")[0];e.font=f.attributes.getNamedItem("face").nodeValue;e.size=parseInt(f.attributes.getNamedItem("size").nodeValue,10);e.lineHeight=parseInt(k.attributes.getNamedItem("lineHeight").nodeValue,10);e.chars={};k=this.ajaxRequest.responseXML.getElementsByTagName("char");for(f=0;f<k.length;f++){var h=parseInt(k[f].attributes.getNamedItem("id").nodeValue,10),l=new d.Rectangle(parseInt(k[f].attributes.getNamedItem("x").nodeValue,10),parseInt(k[f].attributes.getNamedItem("y").nodeValue,
10),parseInt(k[f].attributes.getNamedItem("width").nodeValue,10),parseInt(k[f].attributes.getNamedItem("height").nodeValue,10));e.chars[h]={xOffset:parseInt(k[f].attributes.getNamedItem("xoffset").nodeValue,10),yOffset:parseInt(k[f].attributes.getNamedItem("yoffset").nodeValue,10),xAdvance:parseInt(k[f].attributes.getNamedItem("xadvance").nodeValue,10),kerning:{},texture:d.TextureCache[h]=new d.Texture(this.texture,l)}}k=this.ajaxRequest.responseXML.getElementsByTagName("kerning");for(f=0;f<k.length;f++){var h=
parseInt(k[f].attributes.getNamedItem("first").nodeValue,10),l=parseInt(k[f].attributes.getNamedItem("second").nodeValue,10),m=parseInt(k[f].attributes.getNamedItem("amount").nodeValue,10);e.chars[l].kerning[h]=m}d.BitmapText.fonts[e.font]=e;var n=this;c.addEventListener("loaded",function(){n.onLoaded()});c.load()}};d.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};d.SpineLoader=function(c,e){d.EventTarget.call(this);this.url=c;this.crossorigin=e;this.loaded=
!1};d.SpineLoader.prototype.constructor=d.SpineLoader;d.SpineLoader.prototype.load=function(){var c=this,e=new d.JsonLoader(this.url,this.crossorigin);e.addEventListener("loaded",function(d){c.json=d.content.json;c.onJSONLoaded()});e.load()};d.SpineLoader.prototype.onJSONLoaded=function(){var c=(new p.SkeletonJson).readSkeletonData(this.json);d.AnimCache[this.url]=c;this.onLoaded()};d.SpineLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};d.AbstractFilter=
function(c,d){this.passes=[this];this.dirty=!0;this.padding=0;this.uniforms=d||{};this.fragmentSrc=c||[]};d.ColorMatrixFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;",
"   gl_FragColor = gl_FragColor * vColor;","}"]};d.ColorMatrixFilter.prototype=Object.create(d.AbstractFilter.prototype);d.ColorMatrixFilter.prototype.constructor=d.ColorMatrixFilter;Object.defineProperty(d.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(c){this.uniforms.matrix.value=c}});d.GrayFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={gray:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;",
"varying float vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","   gl_FragColor = gl_FragColor * vColor;","}"]};d.GrayFilter.prototype=Object.create(d.AbstractFilter.prototype);d.GrayFilter.prototype.constructor=d.GrayFilter;Object.defineProperty(d.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},
set:function(c){this.uniforms.gray.value=c}});d.DisplacementFilter=function(c){d.AbstractFilter.call(this);this.passes=[this];c.baseTexture._powerOf2=!0;this.uniforms={displacementMap:{type:"sampler2D",value:c},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}};c.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=c.width,this.uniforms.mapDimensions.value.y=c.height):(this.boundLoadedFunction=
this.onTextureLoaded.bind(this),c.baseTexture.on("loaded",this.boundLoadedFunction));this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;",
"   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","   gl_FragColor = gl_FragColor * vColor;","}"]};d.DisplacementFilter.prototype=Object.create(d.AbstractFilter.prototype);d.DisplacementFilter.prototype.constructor=
d.DisplacementFilter;d.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height;this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(d.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(c){this.uniforms.displacementMap.value=c}});Object.defineProperty(d.DisplacementFilter.prototype,
"scale",{get:function(){return this.uniforms.scale.value},set:function(c){this.uniforms.scale.value=c}});Object.defineProperty(d.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(c){this.uniforms.offset.value=c}});d.PixelateFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1E4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}};this.fragmentSrc=
["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]};d.PixelateFilter.prototype=Object.create(d.AbstractFilter.prototype);d.PixelateFilter.prototype.constructor=
d.PixelateFilter;Object.defineProperty(d.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(c){this.dirty=!0;this.uniforms.pixelSize.value=c}});d.BlurXFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);",
"   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;",
"   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]};d.BlurXFilter.prototype=Object.create(d.AbstractFilter.prototype);d.BlurXFilter.prototype.constructor=d.BlurXFilter;Object.defineProperty(d.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/
(1/7E3)},set:function(c){this.dirty=!0;this.uniforms.blur.value=1/7E3*c}});d.BlurYFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;",
"   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;",
"   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]};d.BlurYFilter.prototype=Object.create(d.AbstractFilter.prototype);d.BlurYFilter.prototype.constructor=d.BlurYFilter;Object.defineProperty(d.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7E3)},set:function(c){this.uniforms.blur.value=1/7E3*c}});d.BlurFilter=function(){this.blurXFilter=new d.BlurXFilter;this.blurYFilter=new d.BlurYFilter;this.passes=
[this.blurXFilter,this.blurYFilter]};Object.defineProperty(d.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(c){this.blurXFilter.blur=this.blurYFilter.blur=c}});Object.defineProperty(d.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(c){this.blurXFilter.blur=c}});Object.defineProperty(d.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(c){this.blurYFilter.blur=c}});d.InvertFilter=function(){d.AbstractFilter.call(this);
this.passes=[this];this.uniforms={invert:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","   gl_FragColor = gl_FragColor * vColor;","}"]};d.InvertFilter.prototype=Object.create(d.AbstractFilter.prototype);
d.InvertFilter.prototype.constructor=d.InvertFilter;Object.defineProperty(d.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(c){this.uniforms.invert.value=c}});d.SepiaFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={sepia:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);",
"void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","   gl_FragColor = gl_FragColor * vColor;","}"]};d.SepiaFilter.prototype=Object.create(d.AbstractFilter.prototype);d.SepiaFilter.prototype.constructor=d.SepiaFilter;Object.defineProperty(d.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(c){this.uniforms.sepia.value=c}});d.TwistFilter=function(){d.AbstractFilter.call(this);
this.passes=[this];this.uniforms={radius:{type:"1f",value:0.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:0.5,y:0.5}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;",
"       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]};d.TwistFilter.prototype=Object.create(d.AbstractFilter.prototype);d.TwistFilter.prototype.constructor=d.TwistFilter;Object.defineProperty(d.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(c){this.dirty=
!0;this.uniforms.offset.value=c}});Object.defineProperty(d.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(c){this.dirty=!0;this.uniforms.radius.value=c}});Object.defineProperty(d.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(c){this.dirty=!0;this.uniforms.angle.value=c}});d.ColorStepFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={step:{type:"1f",value:5}};this.fragmentSrc=
["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color * vColor;","}"]};d.ColorStepFilter.prototype=Object.create(d.AbstractFilter.prototype);d.ColorStepFilter.prototype.constructor=d.ColorStepFilter;Object.defineProperty(d.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},
set:function(c){this.uniforms.step.value=c}});d.DotScreenFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;",
"   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]};d.DotScreenFilter.prototype=Object.create(d.DotScreenFilter.prototype);d.DotScreenFilter.prototype.constructor=d.DotScreenFilter;Object.defineProperty(d.DotScreenFilter.prototype,
"scale",{get:function(){return this.uniforms.scale.value},set:function(c){this.dirty=!0;this.uniforms.scale.value=c}});Object.defineProperty(d.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(c){this.dirty=!0;this.uniforms.angle.value=c}});d.CrossHatchFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;",
"uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }",
"    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]};d.CrossHatchFilter.prototype=Object.create(d.AbstractFilter.prototype);d.CrossHatchFilter.prototype.constructor=d.BlurYFilter;Object.defineProperty(d.CrossHatchFilter.prototype,
"blur",{get:function(){return this.uniforms.blur.value/(1/7E3)},set:function(c){this.uniforms.blur.value=1/7E3*c}});d.RGBSplitFilter=function(){d.AbstractFilter.call(this);this.passes=[this];this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;",
"uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]};d.RGBSplitFilter.prototype=Object.create(d.AbstractFilter.prototype);d.RGBSplitFilter.prototype.constructor=d.RGBSplitFilter;
Object.defineProperty(d.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7E3)},set:function(c){this.uniforms.blur.value=1/7E3*c}});"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports.PIXI=d):"undefined"!==typeof define&&define.amd?define(d):this.PIXI=d}).call(this);

